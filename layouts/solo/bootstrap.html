{{- $type := .Type -}}
{{- $defaults := getJSON (printf "themes/tvpage/defaults/%s.json" $type) -}}

{{- range $defaults.option -}}
{{- $.Scratch.SetInMap "config" .code .value -}}
{{- end -}}

{{- range readDir "/" -}}
  {{- if eq .Name "defaults" -}}
    {{- if (where (readDir "defaults/") "Name" (printf "%s.json" $type)) -}}
      {{- range (getJSON (printf "defaults/%s.json" $type)).option -}}
      {{- $.Scratch.SetInMap "config" .code .value -}}
      {{- end -}}
    {{- end -}}
  {{- end -}}
{{- end -}}

{{- range $i, $param := .Params -}}
{{- $.Scratch.SetInMap "config" $i . -}}
{{- end -}}

{{- $.Scratch.Set "settings" ($.Scratch.Get "config") -}}

(function(){

  var config = {{ $.Scratch.Get "config" | jsonify }};

  config.type = "{{ .Type }}";

  {{- if (getenv "HUGO_DEBUG") -}}
    config.baseUrl = "{{ trim $.Site.BaseURL "/" }}";
  {{- else -}}
    config.baseUrl = "{{ $.Site.BaseURL }}";
  {{- end -}}

  config.templates = {
    base: {{- (partial (printf "%s/templates/base.html" .Type) .) | htmlUnescape | safeHTML -}},
    menu: {{- (partial (printf "%s/templates/menu.html" .Type) .) | htmlUnescape | safeHTML -}},
    "menu-item": {{- (partial (printf "%s/templates/menu-item.html" .Type) .) | htmlUnescape | safeHTML -}}
  };
  
  config.css = {
    base: {{- (partial (printf "%s/css/base.css" .Type) .) | htmlUnescape | safeHTML -}},
    host: {{- (partial (printf "%s/css/host.css" .Type) .) | htmlUnescape | safeHTML -}},
    "host-custom": {{- (partial (printf "%s/css/host-custom.css" .Type) .) | htmlUnescape | safeHTML -}}
  };

  config.indexFile = "{{ printf "hello" }}";

  {{- (readFile "/themes/tvpage/static/solo/index.js" ) | htmlUnescape | safeHTML -}}



}());