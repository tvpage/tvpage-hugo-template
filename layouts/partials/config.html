{{- $type := .Type -}}
{{- $defaults := (getJSON (printf "themes/tvpage/defaults/%s.json" $type)).option -}}

{{- range $defaults -}}
{{- $.Scratch.SetInMap "config" .code .value -}}
{{- end -}}

{{- range readDir "/" -}}
{{- if eq .Name "defaults" -}}
	{{- if (where (readDir "defaults/") "Name" (printf "%s.json" $type)) -}}
		{{- range (getJSON (printf "defaults/%s.json" $type)).option -}}
		{{- $.Scratch.SetInMap "config" .code .value -}}
		{{- end -}}
	{{- end -}}
{{- end -}}
{{- end -}}

{{- range $i, $param := .Params -}}
{{- $.Scratch.SetInMap "config" $i . -}}
{{- end -}}

{{- range $i, $param := .Site.Params -}}
{{- $.Scratch.SetInMap "config" $i . -}}
{{- end -}}

{{- $.Scratch.Set "settings" ($.Scratch.Get "config") -}}

{{- range $code, $value := ($.Scratch.Get "config") -}}
{{- range where $defaults "code" $code -}}
	{{- if .display -}}
		{{- $.Scratch.Add "custom-css" (printf "%s{%s:%s;}" .selector .property .value) -}}
	{{- end -}}
{{- end -}}
{{- end -}}