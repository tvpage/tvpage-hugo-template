!function(a,b,c,d){var e=0,f=a(".btn-more-button"),g=a("#tvp-desktop-search-input"),h=a("#tvp-null-results"),i=a("#tvp-mobile-search-input"),j=a(".mobile-search-modal-cancel-btn"),k=a("#tvp-mobile-search-results"),l=a("#tvp-mobile-null-results"),m=!1,n=!!/iPhone|iPad|iPod/i.test(navigator.userAgent),o=!1,p=!0,q=!1,r=null,s=[],t=!!/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),u=navigator.userAgent.indexOf("Mac OS X")!=-1,v=navigator.userAgent.indexOf("Firefox")!=-1,w=function(a){return RegExp("msie"+(isNaN(a)?"":"\\s"+a),"i").test(navigator.userAgent)},x=(w(9)||w(10)||u&&v,function(a){var b=["January","February","March","April","May","June","July","August","September","October","November","December"],c=new Date(1e3*Number(a)),d=b[c.getMonth()],e=""+c.getDate()+",",f=c.getFullYear();return[d,e,f].join(" ")}),y={commonRequest:function(b,d,e){return a.ajax({url:b,cache:!1,dataType:"jsonp",data:c.extend({},o?C.selected:{},{p:null==d||void 0==d?0:d,n:(TVSite.isHomePage,6),s:null==e||void 0==e?"":e,"X-login-id":TVSite.loginId,status:"approved",o:"date_created",od:"desc"})})},filters:function(){return a.ajax({url:TVSite.apiUrl+"codebook/display/video",dataType:"jsonp",data:{"X-login-id":TVSite.loginId,channelId:TVSite.channelId}})},products:function(a){var b=TVSite.apiUrl+"videos/"+a+"/products";return this.commonRequest(b,null,null)},channelInfo:function(){},video:function(){},videos:function(a,b,c){var d=TVSite.apiUrl+"videos/search",e=c;return void 0!==a&&null!==a&&(d=TVSite.apiUrl+"channels/"+a+"/videos"),this.commonRequest(d,b,e)}},z={liveResultHtml:'<li><a href="{url}" class="tvp-desktop-search-results-item clearfix"><div class="tvp-desktop-search-results-item-img-holder"><div class="tvp-desktop-search-results-item-img" style="background-image:url({asset.thumbnailUrl});+    \tbackground-position: 50% 50%;"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAP///////yH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" /></div></div><div class="tvp-desktop-search-results-item-text"><p class="tvp-desktop-search-results-item-title">{title}</p><p class="tvp-desktop-search-results-item-description">{description}</p></div></a></li>',videoTemplate:'<div class="col-sm-4 col-md-4"><a href="{url}" class="latest-video"><div class="latest-video-thumbnail"><div class="content" style="background-image: url({asset.thumbnailUrl});"><div class="latest-video-hover"><div class="play-icon"></div></div></div></div><p class="latest-video-title">{title}</p></a></div>',getResultUrl:function(a){var b=function(a){return"undefined"!=typeof a&&null!==typeof a&&a};if(a&&b(a)){var c=TVSite.baseUrl+"/"+(m||o?TVSite.channelInfo.titleTextEncoded:String(a.entityTitleParent).replace(/\s/g,"-").replace(/\./g,""))+"/"+String(a.titleTextEncoded).replace(/\s/g,"-")+"/"+(a.entityIdParent||TVSite.channelId)+"-"+a.id;return c=c.replace("//","/")}},resetLiveSearch:function(){a("#tvp-desktop-search-results ul").empty().closest("#tvp-desktop-search-results-holder").hide()},showEndOfResults:function(){a(".tvp-end-of-results").length||(a("<p></p>").addClass("tvp-end-of-results").html("No more results").appendTo("#tvp-desktop-search-results ul"),this.checkResultsScroller())},createDesktopScroller:function(c){return c&&a(c).children().length?new b(c,{interactiveScrollbars:!0,scrollX:!1,click:!0,mouseWheel:!0,scrollbars:!0}):void 0},handleScrollEnd:function(){if(Math.abs(this.maxScrollY)-Math.abs(this.y)<10){var a=g.val();y.videos(null,e+1,a).done(function(a){z.handleVideoResults(a),e+=1})}},checkResultsScroller:function(){this.resultsScroller?setTimeout(function(){z.resultsScroller.refresh()},0):(this.resultsScroller=this.createDesktopScroller("#tvp-desktop-search-results-holder"),this.resultsScroller.on("scrollEnd",this.handleScrollEnd))},tmpl:function(a,b){if(a&&"object"==typeof b)return a.replace(/\{([\w\.]*)\}/g,function(a,c){for(var d=c.split("."),e=b[d.shift()],f=0,g=d.length;f<g;f++)e=e[d[f]];return"undefined"!=typeof e&&null!==e?e:""})},stripHtml:function(a){var b=document.createElement("DIV");b.innerHTML=a;var c=b.textContent||b.innerText||"";return c},handleVideoResults:function(b){if(b.length){for(var c="",d="#tvp-desktop-search-results-holder",e=0;e<b.length;++e){var f=b[e];f.url=this.getResultUrl(f),"description"in f&&(f.description=this.stripHtml(f.description)),c+=this.tmpl(this.liveResultHtml,f)}a(".brand-header-search-container").hasClass("connector")||a(".brand-header-search-container").addClass("connector"),a("#tvp-desktop-search-results ul").append(c).closest(d).show(),z.checkResultsScroller()}else z.showEndOfResults()},handleLoadMore:function(b){for(var c="",d=0;d<b.length;++d){var e=b[d];e.url=this.getResultUrl(e),c+=this.tmpl(this.videoTemplate,e)}a("#tvp-video-container").append(c),B.onLoadMore()},addFilters:function(b){var c=function(b,c){var d=a("<a/>").attr({value:b.code,href:"#"}),e=a("<li/>");return b.id&&d.attr("id",b.id),d.html(b.label||""),e.append(d[0]),e[0]};for(var d in b){var e=document.createDocumentFragment();e.appendChild(c({code:null,label:d.replace(/_/g," ")}));for(var f=b[d].options,g=0;g<(f?f.length:0);g++)f[g].hasValues&&e.appendChild(c(f[g]));var h=a("#"+d);1===e.childElementCount?h.addClass("tvp-filter-inactive"):(h.html(e),h.removeAttr("style"))}},handleMobileSearchResults:function(a){if(a.length){var b='<li><div class="item"> <a href="{url}" class="latest-video"><div class="latest-video-thumbnail"><div class="content" style="background-image: url({asset.thumbnailUrl})"></div></div><div class="latest-video-title"> {title}</div> </a></div></li>',d="",e=this;c.each(a,function(c,f){var g=a[f];g.url=e.getResultUrl(g),d+=e.tmpl(b,g)})}},renderProd:function(b,c,d){var e="";if(b&&b.length)for(var f=0;f<b.length;f++){var g=JSON.parse(b[f].data||"");b[f].linkUrl=g.linkUrl,b[f].imageUrl=g.imageUrl,e+=z.tmpl(d,b[f])}e.length&&(a(c).html(e),a(c).length>0&&!a(c).is(":hidden"),k.find("ul").html(e).parent().show())}},A={desktop:function(a){return y.videos(null,null,a)},mobile:function(a){return y.videos(null,null,a)}},B={onLoadMore:function(){a(".latest-video").on({click:function(a){TVSite.isPlayerPage},mouseover:function(b){var c=a(this).find(".latest-video-hover");c.hasClass("active")||c.addClass("active")},mouseout:function(b){var c=a(this).find(".latest-video-hover");c.hasClass("active")&&c.removeClass("active")}})},Filters:function(){a("#product_category li a").on("click",function(b){b.preventDefault(),a(this).parent().parent().prev().find(".selected").text(a(this).text());var c=b.currentTarget.id;C.selected.product_category=b.currentTarget.text,e=0,c?C.filterVideos():C.reset()}),a("#type_of_video li a").on("click",function(b){b.preventDefault(),a(this).parent().parent().prev().find(".selected").text(a(this).text());var c=b.currentTarget.id;C.selected.type_of_video=b.currentTarget.text,e=0,c?C.filterVideos():C.reset()})}};g.on("keypress",function(a){13==a.keyCode&&a.preventDefault()}),g.on("keyup",function(b){m=!1;var c=b.keyCode;if(37!==c&&38!==c&&39!==c&&40!==c){b.preventDefault();var d=a(b.target).val();z.resetLiveSearch(),h.find(".tvp-null-results-word").text(d),d?(e=0,A.desktop(d).done(function(b){b.length?(h.hide(),z.handleVideoResults(b)):(a(".brand-header-search-container").hasClass("connector")||a(".brand-header-search-container").addClass("connector"),h.show())})):(h.hide(),a(".brand-header-search-container").hasClass("connector")&&a(".brand-header-search-container").removeClass("connector"))}}),g.focus(function(){g.val()||(a(".brand-header-search-container").animate({width:"+=175"},"fast"),a(".brand-header-logo").animate({marginLeft:"-=175"},"fast"))}).blur(function(){g.val(""),z.resetLiveSearch(),h.hide(),a(".brand-header-search-container").animate({width:"-=175"},"fast"),a(".brand-header-logo").animate({marginLeft:"+=175"},"fast"),a(".brand-header-search-container").hasClass("connector")&&a(".brand-header-search-container").removeClass("connector")}),i.on("keyup",function(b){b.preventDefault();var c=a(b.target).val();c?A.mobile(c).done(function(a){a.length?(l.hide(),z.handleMobileSearchResults(a)):(k.hide(),l.find("b").html(c),l.show())}):(l.hide(),k.hide())}),j.on("click",function(a){a.preventDefault(),i.val(""),l.hide(),k.hide()}),f.on("click",function(a){m=!0,e+=1,y.videos(TVSite.channelId,e,null).done(function(a){a.length?z.handleLoadMore(a):f.attr("disabled",!0)})});var C={selected:{},defaultFilters:null,filters:{type_of_video:{},product_category:{}},reset:function(){a(".tvp-filter-reset").css("display","none"),f.attr("disabled",!1),o=!1,e=0,a("#tvp-video-container").empty(),y.videos(TVSite.channelId,e,null).done(function(a){a.length&&z.handleLoadMore(a)})},filterVideos:function(){a(".tvp-filter-reset").css("display","inline-block"),o=!0,0===e&&a("#tvp-video-container").empty(),y.videos(null,e,null).done(c.bind(function(a){e+=1,a.length&&z.handleLoadMore(a)},this))},initialize:function(){y.filters().done(c.bind(function(b){for(var d=0;d<b.length;d++){var e=b[d],f=e.code;if(f in this.filters)for(var g=["id","label","options"],h=0;h<g.length;h++)this.filters[f][g[h]]=e[g[h]]}z.addFilters(this.filters),B.Filters(),n?a(document).on("touchstart",".tvp-filter-reset",c.bind(function(){this.reset()},this)):a(document).on("click",".tvp-filter-reset",c.bind(function(){a("#product_category").prev().find(".selected").text("Product Category"),a("#type_of_video").prev().find(".selected").text("Type of Video"),this.reset()},this))},this))}},D={updateTitle:function(b){b&&a("#video-playing-title").empty().html(b)},showPlayButton:function(){a("#html5-play-button").show().on("click",function(){window.TVPlayer.play(),a(this).hide()})},buildVideoData:function(a){var b=a.asset||{};b.sources=b.sources||[{file:b.videoId}],b.type=b.type||"youtube";var c=TVSite.channelVideosData,d="";return"object"!=typeof c&&"undefined"!=typeof c.id&&(d=c.id),b.analyticsObj={pg:TVSite.channelId||d,vd:a.id,li:TVSite.loginId},b},playVideo:function(a){if(a){E.destroy(),E.initialize({videoId:a.id,channelId:TVSite.channelId});var b=D.buildVideoData(a);t?(TVPlayer.cueVideo(b),"youtube"!=b.type&&D.showPlayButton()):TVPlayer.loadVideo(b);var c=D.getVideoUrl(a);D.updateSiteUrlAndTitle(c,a.title),D.updateSocialShareLink(c,a)}},updateSiteUrlAndTitle:function(a,b){var c=window.location.protocol+"//"+window.location.host+a;c&&window.history&&history.pushState&&(history.pushState({state:1},null,c),"string"==typeof b&&(b=b),document.title=b)},updateSocialShareLink:function(b,c){a(".facebook").attr("href",function(a,c){return"https://www.facebook.com/sharer/sharer.php?u="+window.location.protocol+"//"+window.location.host+b}),a(".twitter").attr("href",function(a,d){return"https://twitter.com/share?text="+c.title+"%20%7C%0A&url="+window.location.protocol+"//"+window.location.host+b})},getVideoUrl:function(a){var b;if("undefined"!=typeof a.url)b=a.url;else{var c=TVSite.channelVideosData,d="/"+c.id+"-"+a.id,e="";a.titleTextEncoded&&a.titleTextEncoded.length>0&&(e="/"+a.titleTextEncoded);var f="";c.titleTextEncoded&&c.titleTextEncoded.length>0&&(f=TVSite.baseUrl+"/"+c.titleTextEncoded,f=f.replace("//","/")),b=f+e+d}return b},resizePlayer:function(){var b=a("#TVPagePlayer");!q&&b.length&&TVPlayer.resize(b.width(),b.height())},getNextVideo:function(a,b){"undefined"!=typeof a&&"function"==typeof b&&b(a==s.length-1?s[0]:s[a+1])},handleNextvideo:function(a){"object"==typeof a&&(D.updateTitle(a.title),D.startPlayback(a))},getVideoIndex:function(a,b){if("undefined"!=typeof a&&"function"==typeof b){var c=0;for(c;c<s.length;c++)if(a==s[c].id)return b(c);b(null)}},handleAutoNext:function(){D.updateVideoElements(),D.getVideoIndex(r,function(b){D.getNextVideo(b,a.proxy(D.handleNextvideo)),F.initialize({videoId:r})})},startPlayback:function(b){b&&"object"==typeof b&&(D.playVideo(b),r=b.id,y.products(r).done(function(b){z.renderProd(b,"#mobile-products-wrapper",a("#mobileProduct").html()),z.renderProd(b,"#desktop-products-wrapper",a("#desktopProduct").html()),z.renderProd(b,"#desktop-products-pop-ups",a("#productPopup").html())}),D.updateTitle(b.title))},handlePlayerReady:function(){if(s=TVSite.channelVideosData.videos,D.resizePlayer(),p&&"channelVideosData"in TVSite){var a=TVSite.channelVideosData.video;D.startPlayback(a),p=!1}},handlePlayerStateChange:function(a){"tvp:media:videoended"==a&&TVSite.isPlayerPage&&D.handleAutoNext()},updateVideoElements:function(){}},E={status:!1,products:null,queue:{},productTemplate:'<a id="{id}" href="{data.linkUrl}" data-video-id="{entityIdParent}" target="_blank" class="in-time-product"><span class="in-time-unit in-time-title">{title}</span><span class="in-time-unit in-time-cta">VIEW DETAILS</span></a>',initialize:function(a){this.settings=a||{},this.setElement(),this.initializeProducts(),this.status=!0},setElement:function(){a("<div/>").attr("id","in-time-products").prependTo("#player-holder"),this.$el=a("#in-time-products")},getSpotTimeUrl:function(){if("channelId"in this.settings&&"videoId"in this.settings)return TVSite.apiUrl+"spot/link/time/"+this.settings.channelId+"/"+this.settings.videoId},getProducts:function(b){if(b&&"function"==typeof b)return a.ajax({url:this.getSpotTimeUrl(),dataType:"json",data:{"X-login-id":TVSite.loginId}}).done(b)},cleanPrice:function(a){if(a&&"string"==typeof a){if(a.indexOf(".")===-1)return a+".00";var b=a.split(".").pop();if(b.length>2&&b.indexOf("00")!==-1)return a.slice(0,-2);if(1===b.length)return a+"0"}},renderProducts:function(){for(var a="",b=0;b<this.products.length;++b){var c=this.products[b];"data"in c&&"string"==typeof c.data&&(c.data=JSON.parse(c.data)),a+=z.tmpl(this.productTemplate,c)}this.$el.html(a)},initializeProducts:function(){var a=this;this.getProducts(function(b,c){"success"===c&&b.length&&(a.products=b,a.renderProducts(),a.bindProductClick(),a.setQueue(),a.initializeWatcher())})},bindProductClick:function(){this.$el.find(".in-time-product").on("click",function(b){sendAnalytics({vd:a(this).data("videoId"),ct:a(this).attr("id")},"pk")})},setQueue:function(){if(this.products)for(var a=0;a<this.products.length;++a){var b=this.products[a],c=Number(b.startTime)+Number(b.duration);this.queue[b.id]=[Number(b.startTime),c]}},getPlayerTime:function(){return Math.floor(1e3*window.TVPlayer.getCurrentTime())},initializeWatcher:function(){var a=this;this.watcher=setInterval(function(){for(var b in a.queue){var c=a.getPlayerTime(),d=a.queue[b];c>d[0]&&c<d[1]&&a.showProduct(b),c<d[0]&&a.hideProduct(b),c>d[1]&&a.hideProduct(b)}},50)},hideProduct:function(a){"undefined"!==a&&this.$el.find("#"+a).css("top","-100px")},showProduct:function(a){var b=this.$el.find("#"+a);"-100px"===b.css("top")&&b.css("top","0")},destroy:function(){this.status&&(clearInterval(this.watcher),this.$el.find(".in-time-product").off(),this.$el.remove(),this.status=!1)}},F={products:[],$currentPopUp:null,currentId:0,el:'[data-toggle="popover"]',initialize:function(b){this.destroy();var c=b||{},d=this;y.products(c.videoId).done(function(b){b.length&&(d.products=b,d.renderProducts(b),G.registerProductPanel(a("#tvp-products-wrapper .tvp-product-image")),d.bindEvents(),d.initializeSlider())})},renderProducts:function(b){var d='<li> <a data-id="{id}" href="{linkUrl}" target="_blank" class="analyticsClick"><div id="{id}" data-toggle="popover" class="tvp-product-image" data-videoId="{videoId}"><div class="content"> <img src="{imageUrl}" alt=""></div></div> </a></li>',e="";this.products=b,c.each(b,function(a,f){var g=b[f];"Y"===g.OUT_OF_STOCK&&c.isEmpty(g.price)?g.price="Out Of Stock":g.price.indexOf("$")<0&&(g.price="$"+g.price),g.videoId=r||TVSite.channelVideosData.video.id,e+=z.tmpl(d,g)}),a(".tvp-products-wrapper ul").html(e)},bindEvents:function(){var b=this;a(this.el).popover({placement:"left",template:'<div class="popover tvp-prod-hover" role="tooltip"><div class="arrow"></div><div class="popover-content tvp-prod-hover-content"></div></div>',html:!0,trigger:"manual",container:"div.player-product",content:function(){var d='<div class="tvp-prod-hover-img-container"><div class="content"> <img src="{imageUrl}" alt=""></div></div><div class="tvp-prod-hover-title">{title}</div><div class="tvp-prod-hover-price-rate"> <span class="price">{price}</span></div> <a data-id="{id}" href="{linkUrl}" target="_blank" class="btn btn-primary btn-more-button analyticsClick">VIEW DETAILS</a>',e="";prodId=a(this).attr("id");var f=c.filter(b.products,function(a){return a.id==prodId})[0];return e=z.tmpl(d,f)}}).on({mouseenter:function(){if(0===b.currentId)a(this).popover("show");else{var c=a(this).attr("id");c!==b.currentId&&(a('div[id="'+b.currentId+'"][data-toggle="popover"]').popover("hide"),a(this).popover("show"))}},"show.bs.popover":function(){b.currentId=a(this).attr("id")},"hide.bs.popover":function(){b.currentId=0}}),a(".player-product").on("mouseleave",".popover",function(){a('div[id="'+b.currentId+'"]').popover("hide"),b.currentId=0}).on("mouseleave",function(){a('*[data-toggle="popover"]').popover("hide")}).on("click",".analyticsClick",function(b){b.stopPropagation(),G.registerProductClick(a(this).data("id"))})},initializeSlider:function(){new b("#tvp-products-wrapper",{interactiveScrollbars:!0,scrollX:!1,mouseWheel:!0,scrollbars:!0})},destroy:function(){a(this.el).popover("destroy")}},G={registerProductPanel:function(b){var d=this;c.each(b,function(b,c){d.sendAnalytics({vd:a(b).data("videoid"),ct:a(b).attr("id")},"pi")})},registerProductClick:function(a){this.sendAnalytics({vd:r||TVSite.channelVideosData.video.id,ct:a},"pk")},sendAnalytics:function(b,c){if("object"==typeof b&&c)return _tvpa.push(["track",c,a.extend(b,{li:TVSite.loginId,pg:TVSite.channelId})])}};a(".slider").slick({infinite:!0,speed:900,slidesToShow:3,slidesToScroll:1,responsive:[{breakpoint:768,settings:{arrows:!1,slidesToShow:4,slidesToScroll:3}}]}),B.onLoadMore(),TVSite.isChannelPage&&C.initialize(),TVSite.isPlayerPage&&(window.TVPlayer=new TVPage.player({divId:"TVPagePlayer",swf:"//appcdn.tvpage.com//player/assets/tvp/tvp-1.5.2-flash.swf",displayResolution:D.playerResolution,analytics:{tvpa:!0},techOrder:D.playerTechOrder,onReady:D.handlePlayerReady,onStateChange:D.handlePlayerStateChange,controls:{active:!0,seekBar:{progressColor:"#779050"},floater:{removeControls:["tvplogo"]}}}),d&&(d.onchange=function(){q=!q}),a(window).resize(function(){q||D.resizePlayer()}),F.initialize({videoId:TVSite.channelVideosData.video.id}),a('div[itemprop="video"] meta[itemprop="uploadDate"],meta[itemprop="datePublished"]').attr("content",function(a,b){return x(b)})),a("#subscribe-header").on("click",function(b){b.preventDefault(),a("#subcribeModal").modal("show").find(".channel-title, .chkSubscribeAll").css("display","none")}),a("#subscribe-channel").on("click",function(b){return b.preventDefault(),t?(window.location.href="/subscribe/"+a(this).data("channelid"),!1):void a("#subcribeModal").modal("show").find(".channel-title, .chkSubscribeAll").css("display","block")}),a("#subcribeModal").on("show.bs.modal",function(b){a(".subscribe-body").show(),a(".subscribed-body").hide()}),a(".subscribe-button").on("click",function(b){b.preventDefault(),a(".subscribe-body").hide(),a(".subscribed-body").show()}),a(".video-details .published-date").text(function(a,b){return x(b)}),a("#mobile-menu").on("click",function(b){b.preventDefault(),a("#mobile-menu-modal").modal()}),a(".mobile.collapse").on({"show.bs.collapse":function(){a(".caret").animate({borderSpacing:-180},{step:function(b,c){a(this).css({"-webkit-transform":"rotate("+b+"deg)","-moz-transform":"rotate("+b+"deg)",transform:"rotate("+b+"deg)"})},duration:"slow",complete:function(){a(this).addClass("up").removeAttr("style")}},"linear")},"hide.bs.collapse":function(){a(".caret").animate({borderSpacing:180},{step:function(b,c){a(this).css({"-webkit-transform":"rotate("+b+"deg)","-moz-transform":"rotate("+b+"deg)",transform:"rotate("+b+"deg)"})},duration:"slow",complete:function(){a(this).removeClass("up").removeAttr("style")}},"linear")}}),a("#mobile-subscribe").click(function(a){a.preventDefault(),window.location.href="/subscribe"}),a("#mobile-search").on("click",function(b){b.preventDefault(),a("#mobile-search-modal").modal()})}(jQuery,window.IScroll,window._,window.BigScreen);