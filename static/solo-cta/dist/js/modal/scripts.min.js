!function(){function a(a){return document.getElementById(a)}function b(a,b){return a.hasOwnProperty(b)}function c(a,b){return a.classList&&a.classList.contains(b)}function d(){return window.parent&&b(window.parent,"__TVPage__")?window.parent.__TVPage__:null}function e(a){return"function"==typeof a}function f(a,b){return a&&(b(a)?a:f(a.parentNode,b))}function g(a){for(var b in a)if(a.hasOwnProperty(b))return!1;return!0}var h=navigator.userAgent,i=document.body,j={};j.isMobile=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(h),j.isIOS=/iPad|iPhone|iPod|iPhone Simulator|iPad Simulator/.test(h)&&!window.MSStream,j.getWidgetHeight=function(){return Math.floor(a("skeleton").getBoundingClientRect().height)},j.attr=function(a,b){return a.getAttribute(b)},j.isEmptyObject=g,j.stopEvent=function(a){a&&(a.preventDefault(),a.stopPropagation())},j.closest=f,j.getRealTargetByClass=function(a,b){return c(a,b)?a:f(a,function(a){return c(a,b)})},j.remove=function(a){a.parentNode.removeChild(a)},j.addClass=function(a,b){a.classList.add(b)},j.removeClass=function(a,b){a.classList.remove(b)},j.getById=a,j.hasClass=c,j.loadScript=function(a,b){var c=document.createElement("script"),d=a.base||"",f=a.params||{},g=0;for(var h in f)f.hasOwnProperty(h)&&(d+=(g>0?"&":"?")+h+"="+f[h],++g);var j="tvp_callback_"+Math.random().toString(36).substring(7);window[j]=function(a){e(b)&&b(a)},d+="&callback="+j,c.src=d,i.appendChild(c)},j.sendMessage=function(a){window.parent&&window.parent.postMessage(a,"*")},j.getByClass=function(a){return document.getElementsByClassName(a||"")[0]},j.isUndefined=function(a){return void 0===a},j.isFunction=e,j.copy=function(a){return JSON.parse(JSON.stringify(a))},j.hasKey=b,j.isEmpty=function(a){for(var b in a)if(a.hasOwnProperty(b))return!1;return!0},j.formatDuration=function(a){if(void 0!==a){var b=new Date(0,0,0);b.setSeconds(Number(a));var c=function(a){return a<10?"0"+a:a};return(b.getHours()||"")+c(b.getMinutes())+":"+c(b.getSeconds())}},j.formatDate=function(a){var b=new Date(1e3*Number(a)),c=""+(b.getMonth()+1),d=""+b.getDate(),e=b.getFullYear();return c.length<2&&(c="0"+c),d.length<2&&(d="0"+d),[c,d,e].join("/")},j.isset=function(a,b){if(arguments.length){var c=a;return b&&(c=a[b]),void 0!==c}},j.extend=function(a){a=a||{};for(var b=1;b<arguments.length;b++)if(arguments[b])for(var c in arguments[b])arguments[b].hasOwnProperty(c)&&(a[c]=arguments[b][c]);return a},j.debounce=function(a,b,c){var d=null;return function(){var e=this,f=arguments,g=function(){d=null,c||a.apply(e,f)},h=c&&!d;clearTimeout(d),d=setTimeout(g,b),h&&a.apply(e,f)}},j.trimText=function(a,b){var c=a||"",d=b?Number(b):0;return a.length>d&&(c=c.substring(0,Number(d))+"..."),c},j.trimPrice=function(a){var b=a||"";return b=b.toString().replace(/[^0-9.]+/g,""),b=parseFloat(b).toFixed(2),b=b>0?"$"+b:""},j.rowerize=function(a,b){for(var c=[],d=a.length,e=0;e<d;e+=b)c.push(a.slice(e,e+b));return c},j.isEvent=function(a){return a&&a.data&&a.data.event},j.addProps=function(a,b){if(g(b)||g(b))return a;for(var c in b)a[c]=b[c];return a},j.getParentConfig=function(a){var c=d();if(!c||!c.config||!b(c.config,a))throw new Error("no config");return c.config[a]},j.tmpl=function(a,b){return!(!a||"object"!=typeof b)&&a.replace(/\{([\w\.]*)\}/g,function(a,c){for(var d=c.split("."),e=b[d.shift()],f=0,g=d.length;f<g;f++)e=e[d[f]];return void 0!==e&&null!==e?e:""})},j.getStyle=function(a,b){var c;return a.currentStyle?c=a.currentStyle[b]:window.getComputedStyle&&(c=document.defaultView.getComputedStyle(a,null).getPropertyValue(b)),c},window.Utils=j}(),function(){function a(){this.config=null}a.prototype.getGlobal=function(){return window._tvpa||[]},a.prototype.getConfigBase=function(a){var b=a||{};return{logUrl:b.logUrl||"",li:b.li||b.loginId||b.loginid,gaDomain:b.domain||""}},a.prototype.initConfig=function(a){this.config=this.getConfigBase(a),a&&a.firstPartyCookies&&a.cookieDomain&&(this.config.firstPartyCookieDomain=a.cookieDomain),this.getGlobal().push(["config",this.config])},a.prototype.track=function(a,b){void 0!==a&&void 0!==b&&this.getGlobal().push(["track",a,b])},window.Analytics=a}(),function(){function a(a,c,d){b.optionsCheck(c),this.options=c,this.el=b.getElement(a),this.eventPrefix=("tvp_"+this.options.id).replace(/-/g,"_"),this.assets=[],this.instance=null,this.initialResize=!0,this.startWith=d||null,this.isFullScreen=!1,this.currentIndex=null,this.onReadyCalled=!1}var b={iOS:/iPad|iPhone|iPod|iPhone Simulator|iPad Simulator/.test(navigator.userAgent)&&!window.MSStream,isMobile:/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),isEmpty:function(a){for(var b in a)if(a.hasOwnProperty(b))return!1;return!0},isUndefined:function(a){return void 0===a},compact:function(a){for(var b in a)a.hasOwnProperty(b)&&!a[b]&&delete a[b];return a},optionsCheck:function(a){if(!a||!a.data||a.data.length<=0)throw new Error("need options")},getElement:function(a){if(!a)throw new Error("need el");return"string"==typeof a?document.getElementById(a):a}};a.prototype.getPlayButtonOptions=function(){return b.compact({height:this.getOption("play_button_height"),width:this.getOption("play_button_width"),backgroundColor:this.getOption("play_button_background_color"),borderRadius:this.getOption("play_button_border_radius"),borderWidth:this.getOption("play_button_border_width"),borderColor:this.getOption("play_button_border_color"),borderStyle:this.getOption("play_button_border_style"),iconColor:this.getOption("play_button_icon_color")})},a.prototype.setControlsOptions=function(){this.controls=b.compact({active:!0,seekBar:b.compact({progressColor:this.getOption("progress_color")}),floater:b.compact({controlbarColor:this.getOption("control_bar_color"),iconColor:this.getOption("icon_color"),removeControls:this.getOption("remove_controls")}),playbutton:this.getPlayButtonOptions(),overlayColor:this.getOption("overlay_color"),overlayOpacity:this.getOption("overlay_opacity")})},a.prototype.setAdvertisingOptions=function(){if(this.options.advertising&&!b.isEmpty(this.options.advertising)){var a=this.options.advertising;this.advertising=b.compact({enabled:!!a.enabled,adServerUrl:a.adserverurl||null,adTimeout:a.adtimeout||"2000",maxAds:a.maxads||"100",adInterval:b.isUndefined(a.adinterval)?"0":String(a.adinterval)})}},a.prototype.shallCue=function(a){return b.isMobile||a&&!this.autonext||!this.autoplay},a.prototype.play=function(a,b){this.options.debug&&console.log("will play: ",a),"string"==typeof a&&(a=this.getAssetById(a).asset),this.shallCue(b)?this.instance.cueVideo(a):this.instance.loadVideo(a)},a.prototype.controlBarZindex=function(){var a=this.el.querySelector("#ControlBarFloater");a&&a.parentNode&&(a.parentNode.style.zIndex="9999")},a.prototype.getParentSize=function(a){var b=this.el.parentNode,c=null;return"width"===a?c=b.offsetWidth:"height"===a&&(c=b.offsetHeight),c},a.prototype.resize=function(){if(this.getParentSize){var a=arguments[0]||this.getParentSize("width"),b=arguments[1]||this.getParentSize("height");this.instance&&!this.isFullScreen&&this.instance.resize(a,b),this.initialResize=!1,this.onResize&&this.onResize(this.initialResize,[a,b])}},a.prototype.handleResize=function(){var a=this,b=function(){a.resize.call(a)};window.removeEventListener("resize",b,!1),window.addEventListener("resize",b,!1)},a.prototype.analyticsConfig=function(){var a=this.options,b=a.loginId||a.loginid,c={domain:location.hostname||"",logUrl:a.api_base_url+"/__tvpa.gif",li:b};a.firstPartyCookies&&a.cookieDomain&&(c.firstPartyCookieDomain=a.cookieDomain),_tvpa.push(["config",c]),this.options.ciTrack&&_tvpa.push(["track","ci",{li:b}])},a.prototype.getCurrentAsset=function(){return this.assets[this.currentIndex]},a.prototype.getAssetById=function(a){for(var b=this.assets,c=b.length,d={i:null,asset:null},e=0;e<c;e++)b[e].assetId===a&&(d.index=e,d.asset=b[e]);return d},a.prototype.onReady=function(a,b){this.onReadyCalled?this.resize.call(this):(this.resize.call(this),this.analyticsConfig(),this.controlBarZindex(),this.handleResize(),this.onPlayerReady&&this.onPlayerReady(this))},a.prototype.notifyState=function(a){var b=this.getCurrentAsset()||{};b.currentTime=this.instance.getCurrentTime(),this.onPlayerChange&&window.parent&&window.parent.postMessage({event:this.eventPrefix+":widget_player_change",e:a,stateData:b},"*")},a.prototype.handleVideoEnded=function(){this.currentIndex++,this.assets[this.currentIndex]||(this.currentIndex=0);var a=this.assets[this.currentIndex];this.play(a,!0),this.onNext&&this.onNext(a)},a.prototype.onStateChange=function(a){this.notifyState(a),"tvp:media:videoended"===a&&this.handleVideoEnded()},a.prototype.addExtraConfig=function(a){a=a||{};for(var c=["preload","poster","overlay"],d=0;d<c.length;d++){var e=c[d];b.isUndefined(this[e])||null===this[e]||(a[e]=this[e])}return a},a.prototype.getConfig=function(){return b.compact({techOrder:this.getOption("tech_order"),mediaProviders:this.getOption("media_providers"),analytics:{tvpa:this.getOption("analytics")},apiBaseUrl:this.getOption("api_base_url"),swf:this.flashUrl,divId:this.el.id,controls:this.controls,version:this.version,advertising:this.advertising,preload:this.getOption("preload"),poster:this.getOption("poster"),overlay:this.getOption("overlay")})},a.prototype.startPlayer=function(){var a=this.getConfig(),b=this,c=0,d=["TVPage"];!function e(){setTimeout(function(){console.log("deps poll...");for(var f=!0,g=0;g<d.length;g++)void 0===window[d[g]]&&(f=!1);if(f){a.onReady=function(a,c){b.onReady(a,c),b.onReadyCalled=!0},a.onStateChange=function(a){b.onStateChange(a)},b.player=new TVPage.player(a);var h=b.player.options.globalRunId;b.instance=TVPage.instances[h];var i=0,j=b.assets[i];if(b.startWith){var k=b.getAssetById(b.startWith);i=k.index,j=k.asset}b.currentIndex=i,b.play(j)}else++c<200&&e()},5)}()},a.prototype.getChannelId=function(){var a=0,b=this.options;return b.channel?a=b.channel.id:b.channelId?a=b.channelId:b.channelid&&(a=b.channelid),a},a.prototype.buildAsset=function(a){if(b.isEmpty(a))return{};var c=a.asset;return c.assetId=a.id,c.assetTitle=a.title,c.loginId=a.loginId,c.type=c.type||"youtube",c.analyticsObj={pg:a.parentId||this.getChannelId(),vd:c.assetId,li:c.loginId},c.sources=c.sources||[{file:c.videoId}],c},a.prototype.addAssets=function(a){if(a&&a.length)for(var b=0;b<a.length;b++)this.assets.push(this.buildAsset(a[b]))},a.prototype.getOption=function(a){return b.isUndefined(this.options[a])?null:this.options[a]},a.prototype.getCallable=function(a){return"function"==typeof this.options[a]?this.options[a]:null},a.prototype.setConfig=function(a){this.version=this.getOption("player_version"),this.flashUrl="//cdnjs.tvpage.com/tvplayer/tvp-"+this.version+".swf",this.autoplay=this.getOption("autoplay"),this.autonext=this.getOption("autonext"),this.onPlayerChange=this.getOption("onPlayerChange"),this.onResize=this.getCallable("onResize"),this.onNext=this.getCallable("onNext"),this.onPlayerReady=this.getCallable("onPlayerReady")},a.prototype.handleBigScreenChange=function(){if(window.BigScreen){var a=this;BigScreen.onchange=function(){a.isFullScreen=!a.isFullScreen,a.resize()}}},a.prototype.initialize=function(){this.setControlsOptions(),this.setAdvertisingOptions(),this.setConfig(),this.addAssets(this.options.data),this.startPlayer(),this.handleBigScreenChange()},window.Player=a}(),function(){var a=document.body,b=a.getAttribute("data-id"),c=window.parent.__TVPage__.config[b],d=c.events.prefix,e=0,f=["TVPage","Utils","Analytics","Player"];!function a(){setTimeout(function(){console.log("deps poll...");for(var g=!0,h=0;h<f.length;h++)void 0===window[f[h]]&&(g=!1);if(g){var i=Utils.getById(b),j=Utils.copy(c);j.data=c.channel.videos,j.onResize=function(){Utils.sendMessage({event:d+":modal_resize",height:i.offsetHeight+"px"})},j.onNext=function(a){Utils.sendMessage({event:d+":player_next",next:a||{}})};new Player("tvp-player-el",j,c.channel.firstVideo.id).initialize(),Utils.sendMessage({event:d+":widget_modal_initialized",height:i.offsetHeight+20+"px"})}else++e<200&&a()},5)}()}();