!function(){function a(){Utils.sendMessage({event:q.events.resize,height:Utils.getWidgetHeight()})}function b(a){m.track("pk",{vd:a.entityIdParent,ct:a.id,pg:q.channelId})}function c(a){for(var b=0;b<a.length;b++){var c=a[b];m.track("pi",{vd:c.entityIdParent,ct:c.id,pg:q.channelId})}}function d(){v&&w&&(a(),q.profiling.widget_ready=Utils.now("parent"),Utils.sendProfileData(q))}function e(a,b){b||l.play(a),n.endpoint=s+"/videos/"+a+"/products",n.load("render",function(a){c(a),o&&(o.data=a[0],o.render())})}function f(){function b(a){if(Utils.stopEvent(a),a&&a.target){var b=Utils.getRealTargetByClass(a.target,"carousel-item");b&&e(b.getAttribute("data-id"))}}function c(){w=!0,Utils.remove(Utils.getById("skeleton").querySelector(".videos-skel-delete")),p.loadNext("render"),d()}function f(a){l.addAssets(a),q.channel.videos=k.concat(a)}p=new Carousel("videos",{alignArrowsY:["center",".video-image-icon"],page:0,endpoint:t,params:Utils.addProps(A,r),data:k,slidesToShow:4,slidesToScroll:1,onClick:b,itemsTarget:".slick-carousel",itemsPerPage:4,templates:{list:u.videos.list,item:u.videos.item},responsive:[{breakpoint:600,settings:{slidesToShow:2,slidesToScroll:2}}],onReady:c,onLoad:f,onResize:a},q),p.initialize(),p.render()}function g(){m=new Analytics({domain:location.hostname},q),m.initialize(),m.track("ci")}function h(){function e(a){this.el=Utils.getById(a),this.data={},this.handleClick()}function f(a){return a.title=Utils.trimText(a.title,25),a.price=Utils.trimPrice(a.price),a.actionText=a.actionText||"View Details",a}function g(){v=!0,d()}function h(a){Utils.stopEvent(a);var b=Utils.getRealTargetByClass(a.target,"product");if(b){var c=b.getAttribute("data-id");c&&(o.data=n.getDataItemById(c),o.render())}}function i(a){a&&(o=new e("featured-product"),o.data=a[0],o.render(),setTimeout(function(){c(a)},3e3))}function k(){Utils.removeClass(Utils.getById("dots-target-products"),"hide-abs")}var l=u.products;e.prototype.handleClick=function(){var a=this;this.el.addEventListener("click",function(c){b(a.data)})},e.prototype.render=function(){var a="",b=this.data;b&&l&&l.featured&&(a=Utils.tmpl(l.featured,b)),this.el.innerHTML=a},Utils.isMobile?(document.addEventListener("click",function(a){var c=Utils.getRealTargetByClass(a.target,"product");if(c){var d=Utils.attr(c,"data-id")||null;d&&b(n.getDataItemById(d))}},!1),n=new Carousel("products",{appendDots:"#products-carousel-nav",dotsCenter:!0,dotsMax:10,dotsClass:"col py-3 hide-abs",endpoint:s+"/videos/"+j.id+"/products",clean:!0,itemsPerPage:1,loadMore:!1,itemsTarget:".slick-carousel",templates:{list:u.mobile.products.list,item:u.mobile.products.item},responsive:[{breakpoint:600,settings:{dots:!0,arrows:!1}}],params:B,parse:f,onRender:k,onReady:g,onResize:a},q),n.initialize(),n.load("render",c)):(n=new Carousel("products",{alignArrowsY:["center",".carousel-dot-0"],dotsCenter:!0,dots:!0,dotsClass:"products-carousel-dots col py-3 hide-abs",clean:!0,loadMore:!1,endpoint:s+"/videos/"+j.id+"/products",itemsTarget:".slick-carousel",itemsPerPage:4,pageWrapStart:'<div class="carousel-item" >',pageWrapEnd:"</div>",templates:{list:u.products.list,item:u.products.item},params:B,parse:f,onRender:k,onReady:g,onResize:a,onClick:h},q),n.initialize(),n.load("render",i))}function i(){function a(a){var b=a.assetId;b&&e(b)}function b(a,b){Utils.sendMessage({event:q.events.playerChange,e:a,stateData:b}),"tvp:media:videoplaying"===a&&y&&(y=!1,Utils.profile(q,{metric_type:"video_playing",metric_value:Utils.now("parent")-q.profiling.video_playing.start}))}function c(a){if(a&&a.target){Utils.getRealTargetByClass(a.target,"tvplayer-playbutton")&&z&&(z=!1,q.profiling.video_playing={start:Utils.now("parent")})}}function d(){x||(x=!0,q.profiling.video_playing={start:Utils.now("parent")})}l=new Player("player-el",{data:q.channel.videos,ciTrack:!0,onNext:a,onChange:b,onClick:c,onPlayerReady:d},q),l.initialize()}var j,k,l,m,n,o,p,q=window.parent.__TVPage__.config[Utils.attr(document.body,"data-id")],r=q.channel.parameters,s=q.api_base_url,t=s+"/channels/"+q.channelId+"/videos",u=q.templates,v=!1,w=!1,x=!1,y=!0,z=!0,A={o:q.videos_order_by,od:q.videos_order_direction},B={o:q.products_order_by,od:q.products_order_direction};Utils.poll(function(){var a=q.channel.videos;return a&&a.length},function(){k=q.channel.videos,j=k[0],Utils.globalPoll(["jQuery","Utils","Player","Carousel","Analytics"],function(){i(),f(),g(),h()});var a=Utils.getById("widget-title");a.innerHTML=j.title,Utils.addClass(a,"ready")})}();