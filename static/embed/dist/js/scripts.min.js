!function(){function a(a){return document.getElementById(a)}function b(a,b){return a.hasOwnProperty(b)}function c(a){return a.search(/\./)}function d(a){return null===a}function e(a){return"number"==typeof a}function f(a){return"string"==typeof a}function g(a,b){return a.classList&&a.classList.contains(b)}function h(a){return"object"==typeof a}function i(a){return"function"==typeof a}function j(a,b){return a&&(b(a)?a:j(a.parentNode,b))}function k(a){a=a||{};for(var b=1;b<arguments.length;b++)if(arguments[b])for(var c in arguments[b])arguments[b].hasOwnProperty(c)&&(a[c]=arguments[b][c]);return a}function l(a){for(var b in a)if(a.hasOwnProperty(b))return!1;return!0}function m(a,b,c){var d;return a.currentStyle?d=a.currentStyle[c]:window.getComputedStyle&&(d=document.defaultView.getComputedStyle(a,null).getPropertyValue(b)),d}function n(a,b){var c=document.createElement("script"),d=a.base||"",e=a.params||{},f=0;for(var g in e)e.hasOwnProperty(g)&&(d+=(f>0?"&":"?")+g+"="+e[g],++f);if(i(b)){var h="tvp_callback_"+Math.random().toString(36).substring(7);window[h]=function(a){i(b)&&b(a)},d+="&callback="+h}c.src=d,document.body.appendChild(c)}function o(a){console.log("%c "+(a||""),q)}function p(a,c){b(a,"profile")&&a.profile&&o(c.metric_type+": "+c.metric_value+"ms")}var q="color: blue;font-size: 14px;font-weight: bold;display: block;",r={};r.isMobile=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),r.isIOS=/iPad|iPhone|iPod|iPhone Simulator|iPad Simulator/.test(navigator.userAgent)&&!window.MSStream,r.getWidgetHeight=function(){return Math.floor(a("skeleton").getBoundingClientRect().height)},r.now=function(a){var b=window;if("parent"===a&&b.parent&&(b=b.parent),b.performance)return b.performance.now()},r.isNull=d,r.isString=f,r.isNumber=e,r.isObject=h,r.hasDot=c,r.compact=function(a){for(var b in a)a.hasOwnProperty(b)&&!a[b]&&delete a[b];return a},r.inDom=function(a){document.body.contains(a)},r.attr=function(a,b){return a.getAttribute(b)},r.createEl=function(a){return document.createElement(a)},r.isEmptyObject=l,r.stopEvent=function(a){a&&(a.preventDefault(),a.stopPropagation())},r.closest=j,r.getRealTargetByClass=function(a,b){return g(a,b)?a:j(a,function(a){return g(a,b)})},r.remove=function(a){a&&a.parentNode.removeChild(a)},r.addClass=function(a,b){a&&a.classList.add(b)},r.removeClass=function(a,b){a&&a.classList.remove(b)},r.removeObjNulls=function(a){for(var b in a)a.hasOwnProperty(b)&&null===a[b]&&delete a[b];return a},r.getById=a,r.hasClass=g,r.loadScript=n,r.sendMessage=function(a){window.parent&&window.parent.postMessage(a,"*")},r.getByClass=function(a){return document.getElementsByClassName(a||"")[0]},r.isUndefined=function(a){return void 0===a},r.isFunction=i,r.copy=function(a){return JSON.parse(JSON.stringify(a))},r.hasKey=b,r.isEmpty=function(a){for(var b in a)if(a.hasOwnProperty(b))return!1;return!0},r.formatDuration=function(a){if(void 0!==a){var b=new Date(0,0,0);b.setSeconds(Number(a));var c=function(a){return a<10?"0"+a:a};return(b.getHours()||"")+c(b.getMinutes())+":"+c(b.getSeconds())}},r.formatDate=function(a){var b=new Date(1e3*Number(a)),c=""+(b.getMonth()+1),d=""+b.getDate(),e=b.getFullYear();return c.length<2&&(c="0"+c),d.length<2&&(d="0"+d),[c,d,e].join("/")},r.isset=function(a,b){if(arguments.length){var c=a;return b&&(c=a[b]),void 0!==c}},r.extend=k,r.debounce=function(a,b,c){var d=null;return function(){var e=this,f=arguments,g=function(){d=null,c||a.apply(e,f)},h=c&&!d;clearTimeout(d),d=setTimeout(g,b),h&&a.apply(e,f)}},r.trimText=function(a,b){var c=a||"",d=b?Number(b):0;return a.length>d&&(c=c.substring(0,Number(d))+"..."),c},r.log=o,r.profile=p,r.sendProfileData=function(a){setTimeout(function(){if(a&&h(a)){var b=a.profiling||{};for(var c in b)h(b[c])||p(a,{metric_type:c,metric_value:b[c]})}},1e3)},r.trimPrice=function(a){var b=a||"";return b=b.toString().replace(/[^0-9.]+/g,""),b=parseFloat(b).toFixed(2),b=b>0?"$"+b:""},r.rowerize=function(a,b){for(var c=[],d=a.length,e=0;e<d;e+=b)c.push(a.slice(e,e+b));return c},r.isEvent=function(a){return a&&a.data&&a.data.event},r.getWindowWidth=function(a){return Math.max(document.documentElement.clientWidth,window.innerWidth||0)},r.getWindowHeight=function(a){return Math.max(document.documentElement.clientHeight,window.innerHeight||0)},r.addProps=function(a,b){if(l(b)||l(b))return a;for(var c in b)a[c]=b[c];return a},r.tmpl=function(a,b){return!(!a||"object"!=typeof b)&&a.replace(/\{([\w\.]*)\}/g,function(a,c){for(var d=c.split("."),e=b[d.shift()],f=0,g=d.length;f<g;f++)e=e[d[f]];return void 0!==e&&null!==e?e:""})},r.poll=function(a,b){if(!i(a))throw new Error("first argument shall be a function");var c=0;!function d(){setTimeout(function(){if(a()&&i(b))b();else{if(!(++c<1e3))throw new Error("poll condition not met after checking 1000 times");d()}},10)}()},r.getUrlParams=function(){if(window.location){for(var a={},b=location.search.substr(1).split("&"),c=b.length,d=[],e=0;e<c;e++)d.push(b[e]);for(var f=d.length,e=0;e<f;e++){var g=d[e].split("=");g[1]&&(a[g[0]]=g[1])}return a}},r.globalPoll=function(a,b){a=(a||[]).filter(Boolean);var c=a.length,d=0;!function e(){setTimeout(function(){for(var f,g=!0,h=0;h<c;h++){var j=a[h];void 0===window[j]&&(g=!1,f=j)}if(g)i(b)&&b();else{if(!(++d<1e4))throw new Error("missing global: "+f);e()}},10)}()},r.getStyle=m,window.Utils=r}(),function(){function a(a,b){if(!b||!Utils.isObject(b))throw new Error("bad global config");var c=b.loginId;if(!c||isNaN(Number(c)))throw new Error("bad loginId");var d=b.api_base_url,e=a&&a.logUrl?a.logUrl:d?d+"/__tvpa.gif":null;if(!e)throw"can't build url";this.options=a||{},this.config=b,this.logUrl=e}a.prototype.getCookiesConfig=function(){var a=!!this.config.firstPartyCookies;if(a){var b=this.config.cookieDomain;if(Utils.hasDot(b))return{firstPartyCookies:a,cookieDomain:b};throw"bad cookie domain"}return{}},a.prototype.initialize=function(){var a={domain:this.options.domain,li:this.config.loginId,logUrl:this.logUrl};a=Utils.addProps(a,this.getCookiesConfig()),Utils.globalPoll(["_tvpa"],function(){_tvpa.push(["config",a])})},a.prototype.track=function(a,b){var c=b||{li:this.config.loginId};if(Utils.isUndefined(a)||!Utils.isObject(c))throw"bad args";Utils.globalPoll(["_tvpa"],function(){_tvpa.push(["track",a,b])})},window.Analytics=a}(),function(){function a(a,b){if(!b||!Utils.isObject(b))throw new Error("bad global config");var c=a&&a.selector?a.selector:null;if(!a||!Utils.hasKey(a,"selector")||!a.selector)throw"need selector";var d;if(Utils.isString(c)){if(!(d=Utils.getById(c)))throw"element not in dom"}else{if(!c||!Utils.inDom(c))throw"element not in dom";d=c}this.config=b,this.options=a||{},this.el=d,this.assets=[],this.initialResize=!0,this.startWith=this.options.startWith||null,this.currentIndex=null}a.prototype.getOption=function(a){return Utils.isUndefined(this.config[a])?null:this.config[a]},a.prototype.getCallableOption=function(a){return Utils.isFunction(this.options[a])?this.options[a]:null},a.prototype.getPlayButtonOptions=function(){return Utils.compact({height:this.getOption("play_button_height"),width:this.getOption("play_button_width"),backgroundColor:this.getOption("play_button_background_color"),borderRadius:this.getOption("play_button_border_radius"),borderWidth:this.getOption("play_button_border_width"),borderColor:this.getOption("play_button_border_color"),borderStyle:this.getOption("play_button_border_style"),iconColor:this.getOption("play_button_icon_color")})},a.prototype.setControlsOptions=function(){this.controls=Utils.compact({active:!0,seekBar:Utils.compact({progressColor:this.getOption("progress_color")}),floater:Utils.compact({controlbarColor:this.getOption("control_bar_color"),iconColor:this.getOption("icon_color"),removeControls:this.getOption("remove_controls")}),playbutton:this.getPlayButtonOptions(),overlayColor:this.getOption("overlay_color"),overlayOpacity:this.getOption("overlay_opacity")})},a.prototype.setAdvertisingOptions=function(){if(this.options.advertising&&!Utils.isEmpty(this.options.advertising)){var a=this.options.advertising;this.advertising=Utils.compact({enabled:!!a.enabled,adServerUrl:a.adserverurl||null,adTimeout:a.adtimeout||"2000",maxAds:a.maxads||"100",adInterval:Utils.isUndefined(a.adinterval)?"0":String(a.adinterval)})}},a.prototype.shallCue=function(a){return Utils.isMobile||a&&!this.autonext||!this.autoplay},a.prototype.play=function(a,b){if("string"==typeof a){var c=this.getAssetById(a);a=c.asset,this.currentIndex=c.index}else this.currentIndex=this.assets.indexOf(a);this.instance&&(this.shallCue(b)?this.instance.cueVideo(a):this.instance.loadVideo(a))},a.prototype.controlBarZindex=function(){var a=this.el.querySelector("#ControlBarFloater");a&&a.parentNode&&(a.parentNode.style.zIndex="9999")},a.prototype.getParentSize=function(a){var b=this.el.parentNode,c=null;return"width"===a?c=b.offsetWidth:"height"===a&&(c=b.offsetHeight),c},a.prototype.resize=function(){if(this.getParentSize){var a=arguments[0]||this.getParentSize("width"),b=arguments[1]||this.getParentSize("height"),c=document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement;this.instance&&!c&&this.instance.resize(a,b),this.initialResize=!1,this.onResize&&this.onResize(this.initialResize,[a,b])}},a.prototype.handleWindowResize=function(){var a=this,b=function(){setTimeout(function(){a.resize.call(a)},0)};window.removeEventListener("resize",b,!1),window.addEventListener("resize",b,!1)},a.prototype.handleClick=function(){var a=this.options.clickDefaultStop,b=this.options.onClick,c=Utils.isFunction(b)?b:function(b){a&&Utils.stopEvent(b)};this.el.removeEventListener("click",c,!1),this.el.addEventListener("click",c,!1)},a.prototype.analyticsConfig=function(){var a=this.config,b=this.options,c=a.loginId,d={domain:location.hostname||"",logUrl:a.api_base_url+"/__tvpa.gif",li:c};a.firstPartyCookies&&a.cookieDomain&&(d.firstPartyCookieDomain=a.cookieDomain),Utils.globalPoll(["_tvpa"],function(){_tvpa.push(["config",d]),b.ciTrack&&_tvpa.push(["track","ci",{li:c}])})},a.prototype.getCurrentAsset=function(){return this.assets[this.currentIndex]},a.prototype.getAssetById=function(a){for(var b,c=this.assets,d=c.length,e=0;e<d;e++){var f=c[e];f.assetId==a&&(b={index:e,asset:f})}return b},a.prototype.onReady=function(a,b){this.onReadyCalled?this.resize.call(this):(this.resize.call(this),this.analyticsConfig(),this.controlBarZindex(),this.handleWindowResize(),this.handleClick(),this.onPlayerReady&&this.onPlayerReady(this))},a.prototype.handleVideoEnded=function(){this.currentIndex++,this.assets[this.currentIndex]||(this.currentIndex=0);var a=this.assets[this.currentIndex];this.play(a,!0),this.onNext&&this.onNext(a)},a.prototype.onStateChange=function(a){if("tvp:media:videoended"===a&&this.handleVideoEnded(),this.onChange){(this.getCurrentAsset()||{}).currentTime=this.instance.getCurrentTime(),this.onChange(a)}},a.prototype.addExtraConfig=function(a){a=a||{};for(var b=["preload","poster","overlay"],c=0;c<b.length;c++){var d=b[c];Utils.isUndefined(this[d])||null===this[d]||(a[d]=this[d])}return a},a.prototype.getConfig=function(){return Utils.compact({techOrder:this.getOption("tech_order"),mediaProviders:this.getOption("media_providers"),analytics:{tvpa:this.getOption("analytics")},apiBaseUrl:this.getOption("api_base_url"),swf:this.flashUrl,divId:this.el.id,controls:this.controls,version:this.version,advertising:this.advertising,preload:this.getOption("preload"),poster:this.getOption("poster"),overlay:this.getOption("overlay")})},a.prototype.startPlayer=function(){var a=this.getConfig.call(this),b=this;Utils.globalPoll(["TVPage"],function(){a.onReady=function(a,c){b.onReady(a,c),b.onReadyCalled=!0,b.config.player=b.player},a.onStateChange=function(a){b.onStateChange(a)},b.player=new TVPage.player(a);var c=b.player.options.globalRunId;b.instance=TVPage.instances[c];var d=0,e=b.assets[d];if(b.startWith){var f=b.getAssetById(b.startWith);d=f.index,e=f.asset}b.currentIndex=d,b.play(e)})},a.prototype.getChannelId=function(){var a=0,b=this.options;return b.channel?a=b.channel.id:b.channelId?a=b.channelId:b.channelid&&(a=b.channelid),a},a.prototype.buildAsset=function(a){if(Utils.isEmpty(a))return{};var b=a.asset;return b.assetId=a.id,b.assetTitle=a.title,b.loginId=a.loginId,b.type=b.type||"youtube",b.analyticsObj={pg:a.parentId||this.getChannelId(),vd:b.assetId,li:b.loginId},b.sources=b.sources||[{file:b.videoId}],b},a.prototype.addAssets=function(a){a=a||[];var b,c,d=a.length;for(b=0;b<d;b++)c=a[b],this.getAssetById(c.id)||this.assets.push(this.buildAsset(c))},a.prototype.setConfig=function(a){this.version=this.getOption("player_version"),this.flashUrl="//cdnjs.tvpage.com/tvplayer/tvp-"+this.version+".swf",this.autoplay=this.getOption("autoplay"),this.autonext=this.getOption("autonext"),this.onChange=this.getCallableOption("onChange"),this.onResize=this.getCallableOption("onResize"),this.onNext=this.getCallableOption("onNext"),this.onPlayerReady=this.getCallableOption("onPlayerReady"),this.onClick=this.getCallableOption("onClick")},a.prototype.initialize=function(){this.setControlsOptions(),this.setAdvertisingOptions(),this.setConfig(),this.addAssets(this.options.data),this.startPlayer()},window.Player=a}();