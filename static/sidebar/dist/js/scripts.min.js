!function(){var a=navigator.userAgent,b=function(a,b){return a.hasOwnProperty(b)},c={};c.isMobile=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(a),c.isIOS=/iPad|iPhone|iPod|iPhone Simulator|iPad Simulator/.test(a)&&!window.MSStream,c.getById=function(a){return document.getElementById(a)},c.hasClass=function(a,b){return a.classList.contains(b)},c.loadScript=function(a){var b=document.createElement("script"),c=a.base||"",d=a.params||{},e=0;for(var f in d)d.hasOwnProperty(f)&&(c+=(e>0?"&":"?")+f+"="+d[f],++e);b.src=c,document.body.appendChild(b)},c.sendMessage=function(a){window.parent&&window.parent.postMessage(a,"*")},c.getByClass=function(a){return document.getElementsByClassName(a||"")[0]},c.isUndefined=function(a){return void 0===a},c.isFunction=function(a){return"function"==typeof a},c.copy=function(a){return JSON.parse(JSON.stringify(a))},c.hasKey=b,c.isEmpty=function(a){for(var b in a)if(a.hasOwnProperty(b))return!1;return!0},c.formatDuration=function(a){if(void 0!==a){var b=new Date(0,0,0);b.setSeconds(Number(a));var c=function(a){return a<10?"0"+a:a};return(b.getHours()||"")+c(b.getMinutes())+":"+c(b.getSeconds())}},c.formatDate=function(a){var b=new Date(1e3*Number(a)),c=""+(b.getMonth()+1),d=""+b.getDate(),e=b.getFullYear();return c.length<2&&(c="0"+c),d.length<2&&(d="0"+d),[c,d,e].join("/")},c.isset=function(a,b){if(arguments.length){var c=a;return b&&(c=a[b]),void 0!==c}},c.extend=function(a){a=a||{};for(var b=1;b<arguments.length;b++)if(arguments[b])for(var c in arguments[b])arguments[b].hasOwnProperty(c)&&(a[c]=arguments[b][c]);return a},c.debounce=function(a,b,c){var d=null;return function(){var e=this,f=arguments,g=function(){d=null,c||a.apply(e,f)},h=c&&!d;clearTimeout(d),d=setTimeout(g,b),h&&a.apply(e,f)}},c.trimText=function(a,b){var c=a||"",d=b?Number(b):0;return a.length>d&&(c=c.substring(0,Number(d))+"..."),c},c.trimPrice=function(a){var b=a||"";return b=b.toString().replace(/[^0-9.]+/g,""),b=parseFloat(b).toFixed(2),b=b>0?"$"+b:""},c.getParentConfig=function(a){if(!b(window,"parent")||!b(parent,"__TVPage__"))throw new Error("can't access parent");if(!b(parent.__TVPage__,"config")||!b(parent.__TVPage__.config,a))throw new Error("missing config");return parent.__TVPage__.config[a]},c.tmpl=function(a,b){return!(!a||"object"!=typeof b)&&a.replace(/\{([\w\.]*)\}/g,function(a,c){for(var d=c.split("."),e=b[d.shift()],f=0,g=d.length;f<g;f++)e=e[d[f]];return void 0!==e&&null!==e?e:""})},window.Utils=c}(),function(){function a(){this.config=null}var b=function(a){return void 0===a};a.prototype.getConfigBase=function(a){var b=a||{};return{logUrl:b.logUrl||"",li:b.loginId||"",gaDomain:b.domain||""}},a.prototype.initConfig=function(a){if(b(window._tvpa)||!_tvpa)throw new Error("need _tvpa");this.config=this.getConfigBase(a),a&&a.firstPartyCookies&&a.cookieDomain&&(this.config.firstPartyCookieDomain=a.cookieDomain),_tvpa.push(["config",this.config])},a.prototype.track=function(a,c){b(a)||b(c)||_tvpa.push(["track",a,c])},window.Analytics=a}(),function(){var a=document.body,b=function(){return(window.innerWidth||document.documentElement.clientWidth||a.clientWidth)<=200?"small":"medium"},c=function(a,c){this.options=c||{},this.eventPrefix="tvp_"+(c.id||"").trim().replace(/-/g,"_"),this.windowSize=b(),this.initialResize=!0,this.channel=c.channel||{},this.loading=!1,this.el="string"==typeof a?document.getElementById(a):a,this.loadMoreButton=this.el.querySelector(".tvp-sidebar-load"),this.container=this.el.querySelector(".tvp-sidebar-container"),this.titleEl=this.el.querySelector(".tvp-sidebar-title"),this.onLoad=Utils.isFunction(c.onLoad)?c.onLoad:null,this.onLoadEnd=Utils.isFunction(c.onLoadEnd)?c.onLoadEnd:null,this.onItemClick=Utils.isFunction(c.onItemClick)?c.onItemClick:null};c.prototype.renderTitle=function(){var a=this.options.title_text;a.trim().length?this.titleEl.innerHTML=a:this.titleEl.parentNode.removeChild(this.titleEl)},c.prototype.renderItem=function(a){var b="";return"medium"===this.windowSize&&this.itemsPerRow>1&&(b+=" col-6"),a.className=b,a.title=Utils.trimText(a.title,50),Utils.tmpl(this.options.templates["sidebar-item"],a)},c.prototype.render=function(){this.renderTitle();for(var a=this.data.slice(0),b=[];a.length;)b.push(a.splice(0,this.itemsPerPage));for(var c=0;c<b.length;c++){for(var d=b[c],e=[],f=document.createDocumentFragment();d.length;)e.push(d.splice(0,this.itemsPerRow));for(var g=0;e.length>g;g++){var h=document.createElement("div");h.className="tvp-clearfix";for(var i=e[g],j=0;j<i.length;j++)h.innerHTML+=this.renderItem(i[j]);f.appendChild(h)}this.container.innerHTML="",this.container.appendChild(f),Utils.sendMessage({event:this.eventPrefix+":render",height:this.el.offsetHeight+"px"})}},c.prototype.load=function(a){this.loading=!0,this.onLoad&&this.onLoad();var b=this.channel||{},c=b.id||this.options.channelid||this.options.channelId;Utils.loadScript({base:this.options.api_base_url+"/channels/"+c+"/videos",params:Utils.extend(b.parameters||{},{"X-login-id":this.options.loginId||this.options.loginid,p:this.page,n:this.itemsPerPage,o:this.options.videos_order_by,od:this.options.videos_order_direction,callback:"tvpcallback"})});var d=this;window.tvpcallback=function(b){(!b.length||b.length<d.itemsPerPage)&&(d.isLastPage=!0),d.loading=!1,d.data=b,a(b),d.onLoadEnd&&d.onLoadEnd()}},c.prototype.next=function(){this.isLastPage?(this.page=0,this.isLastPage=!1):this.page++},c.prototype.resize=function(){var a=this,c=function(){this.initialResize||Utils.sendMessage({event:a.eventPrefix+":resize",height:a.el.offsetHeight+"px"})},d=b();this.windowSize!==d?(this.windowSize=d,this.itemsPerPage="small"===d?2:this.options.itemsPerPage||6,this.itemsPerRow="small"===d?1:this.options.itemsPerRow||2,this.page=0,this.isLastPage=!1,this.load(function(){a.render(),c()})):c(),this.initialResize=!1},c.prototype.setPagination=function(){this.page=0,this.isLastPage=!1;var a="small"===this.windowSize;this.itemsPerPage=a?2:this.options.items_per_page||6,this.itemsPerRow=a?1:this.options.items_per_row||2},c.prototype.handleClick=function(){var a=this;this.el.addEventListener("click",function(b){var c=b.target,d=c.id.split("-").pop();if(Utils.hasClass(c,"tvp-video")&&d){for(var e={},f=a.data,g=0;g<f.length;g++)f[g].id===d&&(e=f[g]);Utils.sendMessage({runTime:Utils.isUndefined(window.__TVPage__)?null:__TVPage__,event:a.eventPrefix+":video_click",selectedVideo:e,videos:f})}})},c.prototype.handleLoadMoreClick=function(){var a=this;this.loadMoreButton.addEventListener("click",function(){a.loading||(a.next(),a.load(function(b){b.length?a.render(b):(a.next(),a.load(function(b){a.render(b)}))}))})},c.prototype.initialize=function(){this.setPagination(),this.handleClick(),this.handleLoadMoreClick();var a=this;this.load(function(b){b.length&&(a.render(b),Utils.sendMessage({event:a.eventPrefix+":render"}))}),window.addEventListener("resize",function(){Utils.debounce(a.resize.call(a),100)})},window.Grid=c}(),function(a,b){var c=function(a,c){if(Utils.isset(a)&&Utils.isset(c)){var d=b.createDocumentFragment(),e=b.createElement("div"),f=c||{};e.id=f.id||"",e.classList.add("iframe-content"),e.innerHTML+=f.templates.sidebar,d.appendChild(e),a.appendChild(d)}},d=function(){var a=b.body,d={};Utils.isset(parent)&&Utils.isset(parent,"__TVPage__")&&Utils.isset(parent.__TVPage__,"config")&&(d=parent.__TVPage__.config[a.getAttribute("data-id")]);var e=JSON.parse(JSON.stringify(d)),f=d.name;c(a,d);var g=b.getElementById(f);e.onLoad=function(){g.classList.add("loading")},e.onLoadEnd=function(){g.classList.remove("loading")};var h=new Analytics;h.initConfig({logUrl:d.api_base_url+"/__tvpa.gif",domain:Utils.isset(location,"hostname")?location.hostname:"",firstPartyCookies:d.firstpartycookies,cookieDomain:d.cookiedomain,loginId:d.loginid}),h.track("ci",{li:d.loginid}),new Grid(f,e).initialize()},e=function(a){return void 0===a};if(e(a.Grid)||e(a.Utils)||e(a._tvpa)||e(a.Analytics)){var f=0;!function b(){setTimeout(function(){(e(a.Grid)||e(a.Utils)||e(a._tvpa)||e(a.Analytics))&&++f<50?b():d()},150)}()}else d()}(window,document);