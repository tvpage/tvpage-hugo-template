!function(){function a(a){return document.getElementById(a)}function b(a,b){return a.hasOwnProperty(b)}function c(a){return"null"==typeof a}function d(a,b){return a.classList&&a.classList.contains(b)}function e(a){return"object"==typeof a}function f(a){return"function"==typeof a}function g(a,b){return a&&(b(a)?a:g(a.parentNode,b))}function h(a){a=a||{};for(var b=1;b<arguments.length;b++)if(arguments[b])for(var c in arguments[b])arguments[b].hasOwnProperty(c)&&(a[c]=arguments[b][c]);return a}function i(a){for(var b in a)if(a.hasOwnProperty(b))return!1;return!0}function j(a,b){var c;return a.currentStyle?c=a.currentStyle[b]:window.getComputedStyle&&(c=document.defaultView.getComputedStyle(a,null).getPropertyValue(b)),c}function k(a,b){var c=document.createElement("script"),d=a.base||"",e=a.params||{},g=0;for(var h in e)e.hasOwnProperty(h)&&(d+=(g>0?"&":"?")+h+"="+e[h],++g);if(f(b)){var i="tvp_callback_"+Math.random().toString(36).substring(7);window[i]=function(a){f(b)&&b(a)},d+="&callback="+i}c.src=d,document.body.appendChild(c)}function l(a,c){if(b(a,"profile")&&a.profile){console.log("%c "+c.metric_type+": "+c.metric_value+"ms","color: blue;font-size: 14px;font-weight: bold;display: block;")}}var m={};m.isMobile=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),m.isIOS=/iPad|iPhone|iPod|iPhone Simulator|iPad Simulator/.test(navigator.userAgent)&&!window.MSStream,m.getWidgetHeight=function(){return Math.floor(a("skeleton").getBoundingClientRect().height)},m.now=function(a){var b=window;if("parent"===a&&b.parent&&(b=b.parent),b.performance)return b.performance.now()},m.isNull=c,m.isObject=e,m.compact=function(a){for(var b in a)a.hasOwnProperty(b)&&!a[b]&&delete a[b];return a},m.attr=function(a,b){return a.getAttribute(b)},m.createEl=function(a){return document.createElement(a)},m.isEmptyObject=i,m.stopEvent=function(a){a&&(a.preventDefault(),a.stopPropagation())},m.closest=g,m.getRealTargetByClass=function(a,b){return d(a,b)?a:g(a,function(a){return d(a,b)})},m.remove=function(a){a&&a.parentNode.removeChild(a)},m.addClass=function(a,b){a&&a.classList.add(b)},m.removeClass=function(a,b){a&&a.classList.remove(b)},m.removeObjNulls=function(a){for(var b in a)a.hasOwnProperty(b)&&null===a[b]&&delete a[b];return a},m.getById=a,m.hasClass=d,m.loadScript=k,m.sendMessage=function(a){window.parent&&window.parent.postMessage(a,"*")},m.getByClass=function(a){return document.getElementsByClassName(a||"")[0]},m.isUndefined=function(a){return void 0===a},m.isFunction=f,m.copy=function(a){return JSON.parse(JSON.stringify(a))},m.hasKey=b,m.isEmpty=function(a){for(var b in a)if(a.hasOwnProperty(b))return!1;return!0},m.formatDuration=function(a){if(void 0!==a){var b=new Date(0,0,0);b.setSeconds(Number(a));var c=function(a){return a<10?"0"+a:a};return(b.getHours()||"")+c(b.getMinutes())+":"+c(b.getSeconds())}},m.formatDate=function(a){var b=new Date(1e3*Number(a)),c=""+(b.getMonth()+1),d=""+b.getDate(),e=b.getFullYear();return c.length<2&&(c="0"+c),d.length<2&&(d="0"+d),[c,d,e].join("/")},m.isset=function(a,b){if(arguments.length){var c=a;return b&&(c=a[b]),void 0!==c}},m.extend=h,m.debounce=function(a,b,c){var d=null;return function(){var e=this,f=arguments,g=function(){d=null,c||a.apply(e,f)},h=c&&!d;clearTimeout(d),d=setTimeout(g,b),h&&a.apply(e,f)}},m.trimText=function(a,b){var c=a||"",d=b?Number(b):0;return a.length>d&&(c=c.substring(0,Number(d))+"..."),c},m.profile=l,m.sendProfileData=function(a){setTimeout(function(){if(a&&e(a)){var b=a.profiling||{};for(var c in b)e(b[c])||l(a,{metric_type:c,metric_value:b[c]})}},1e3)},m.trimPrice=function(a){var b=a||"";return b=b.toString().replace(/[^0-9.]+/g,""),b=parseFloat(b).toFixed(2),b=b>0?"$"+b:""},m.rowerize=function(a,b){for(var c=[],d=a.length,e=0;e<d;e+=b)c.push(a.slice(e,e+b));return c},m.isEvent=function(a){return a&&a.data&&a.data.event},m.getWindowWidth=function(a){return Math.max(document.documentElement.clientWidth,window.innerWidth||0)},m.getWindowHeight=function(a){return Math.max(document.documentElement.clientHeight,window.innerHeight||0)},m.addProps=function(a,b){if(i(b)||i(b))return a;for(var c in b)a[c]=b[c];return a},m.tmpl=function(a,b){return!(!a||"object"!=typeof b)&&a.replace(/\{([\w\.]*)\}/g,function(a,c){for(var d=c.split("."),e=b[d.shift()],f=0,g=d.length;f<g;f++)e=e[d[f]];return void 0!==e&&null!==e?e:""})},m.poll=function(a,b){if(!f(a))throw new Error("first argument shall be a function");var c=0;!function d(){setTimeout(function(){if(a())f(b)&&b();else{if(!(++c<1e3))throw new Error("poll condition not met after checking 1000 times");d()}},10)}()},m.getUrlParams=function(){if(window.location){for(var a={},b=location.search.substr(1).split("&"),c=b.length,d=[],e=0;e<c;e++)d.push(b[e]);for(var f=d.length,e=0;e<f;e++){var g=d[e].split("=");g[1]&&(a[g[0]]=g[1])}return a}},m.globalPoll=function(a,b){a=(a||[]).filter(Boolean);var c=a.length,d=0;!function e(){setTimeout(function(){for(var g,h=!0,i=0;i<c;i++){var j=a[i];void 0===window[j]&&(h=!1,g=j)}if(h)f(b)&&b();else{if(!(++d<1e3))throw new Error("missing global: "+g);e()}},10)}()},m.getStyle=j,window.Utils=m}(),function(){function a(a,b){if(this.options=a||{},this.config=b||{},Utils.isUndefined(this.options.domain))throw new Error("need domain")}a.prototype.initialize=function(){var a=this;Utils.globalPoll(["_tvpa"],function(){var b=a.options;b.firstPartyCookies&&b.cookieDomain&&(b.firstPartyCookieDomain=b.cookieDomain);var c="";if(b.logUrl?c=b.logUrl:a.config.api_base_url&&(c=a.config.api_base_url+"/__tvpa.gif"),!c)throw new Error("can't build logUrl");_tvpa.push(["config",{li:b.loginId,domain:b.domain,logUrl:c,firstPartyCookies:a.config.firstpartycookies,cookieDomain:a.config.cookiedomain}])})},a.prototype.track=function(a,b){var c=this.config.loginId;if(Utils.isUndefined(a)||Utils.isUndefined(c))throw new Error("bad event or loginId",a);Utils.globalPoll(["_tvpa"],function(){_tvpa.push(a,b||{li:c})})},window.Analytics=a}(),function(){function a(a,b,c){this.options=b||{},this.data=this.options.data||[],this.config=c||{},this.eventPrefix=c.events.prefix,this.templates=this.options.templates,this.channel=this.config.channel||{},this.loading=!1,this.el="string"==typeof a?document.getElementById(a):a,this.loadMoreButton=Utils.getById("load-more"),this.itemClass=".sidebar-item",this.itemsPerPage=this.config.items_per_page||6,this.itemsPerRow=this.config.items_per_row||2,this.onLoad=Utils.isFunction(b.onLoad)?b.onLoad:null,this.onItemClick=Utils.isFunction(b.onItemClick)?b.onItemClick:null,this.onReadyCalled=!1,this.page=0,this.isLastPage=!1}a.prototype.parse=function(){for(var a=this.data.length,b=0;b<a;b++)Utils.isFunction(this.options.parse)&&this.options.parse(this.data[b])},a.prototype.onReady=function(){if(!this.onReadyCalled){var a=this.options.onReady;Utils.isFunction(a)&&a(),this.data.length>=this.itemsPerPage?(Utils.addClass(this.loadMoreButton,"ready"),this.handleLoadMoreClick()):Utils.remove(this.loadMoreButton),this.onReadyCalled=!0}},a.prototype.render=function(){function a(a){for(var b='<div class="row mt-2">',c=a.length,d=0;d<c;d++)b+=Utils.tmpl(this.templates.item,a[d]);return b+="</div>"}function b(){for(var b="",c=0;c<e;c++)for(var f=d[c],g=Utils.rowerize(f,this.itemsPerRow),h=g.length,i=0;i<h;i++)b+=a.call(this,g[i]);return b}var c=this.data;if(c.length){this.parse();var d=Utils.rowerize(c,this.itemsPerPage),e=d.length;this.el.innerHTML=Utils.tmpl(this.templates.list,this.config),this.el.querySelector("#sidebar-container").innerHTML=b.call(this),this.onReady(),this.handleClick()}},a.prototype.load=function(a){this.loading=!0;var b=this;Utils.loadScript({base:this.config.api_base_url+"/channels/"+this.config.channelId+"/videos",params:Utils.extend(this.channel.parameters||{},{"X-login-id":this.config.loginId,p:this.page,n:this.itemsPerPage,o:this.config.videos_order_by,od:this.config.videos_order_direction,callback:"tvpcallback"})},function(c){b.onLoad&&b.onLoad(c),(!c.length||c.length<b.itemsPerPage)&&(b.isLastPage=!0),b.loading=!1,b.data=c,a(c)})},a.prototype.next=function(){this.isLastPage?(this.page=0,this.isLastPage=!1):this.page++},a.prototype.handleClick=function(){for(var a=this.options.clickDefaultStop,b=this.options.onClick,c=Utils.isFunction(b)?b:function(b){a&&Utils.stopEvent(b)},d=this.el.querySelectorAll(this.itemClass),e=d.length,f=0;f<e;f++)d[f].removeEventListener("click",c,!1),d[f].addEventListener("click",c,!1)},a.prototype.handleLoadMoreClick=function(){function a(){b.loading||(b.next(),b.load(function(a){a.length?b.render(a):(b.next(),b.load(function(a){b.render(a)}))}))}var b=this;this.loadMoreButton.removeEventListener("click",a,!1),this.loadMoreButton.addEventListener("click",a,!1)},a.prototype.initialize=function(){},window.Grid=a}(),function(){function a(){Utils.sendMessage({event:g,height:Utils.getWidgetHeight()})}function b(){function a(a){return a.title=Utils.trimText(a.title,25),a}function b(){Utils.remove(k.querySelector(".videos-skel-delete")),d.profiling.widget_ready=Utils.now("parent"),Utils.sendProfileData(d)}function c(a){d.channel.videos=d.channel.videos.concat(a)}function f(a){a&&a.target&&(Utils.sendMessage({event:h,clicked:Utils.attr(Utils.getRealTargetByClass(a.target,"video"),"data-id")}),d.profiling.modal_ready={start:Utils.now("parent")})}var g=new Grid("videos",{data:e,templates:{list:j.videos.list,item:j.videos.item},parse:a,onReady:b,onClick:f,onLoad:c},d);g.initialize(),g.render()}function c(){analytics=new Analytics({domain:location.hostname},d),analytics.initialize(),analytics.track("ci")}var d=window.parent.__TVPage__.config[Utils.attr(document.body,"data-id")],e=d.channel.videos,f=(d.channel.parameters,d.events.prefix),g=f+":widget_resize",h=f+":widget_modal_open",i=d.api_base_url,j=(d.channelId,d.templates),k=Utils.getById("skeleton");Utils.poll(function(){return"hidden"===Utils.getStyle(Utils.getById("bscheck"),"visibility")},function(){var b=Utils.getById("widget-title");b.innerHTML=d.title_text,Utils.addClass(b,"ready"),Utils.addClass(k,"ready"),a(),d.profiling.skeleton_shown=Utils.now("parent")}),Utils.globalPoll(["Utils","Analytics","Grid"],function(){c(),b();var d=!0;window.addEventListener("resize",function(){if(d)return void(d=!1);a()})})}();