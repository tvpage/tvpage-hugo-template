!function(a,b){function c(){this.isMobile=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),this.getByClass=function(a){return b.getElementsByClassName(a||"")[0]},this.isFunction=function(a){return"function"==typeof a},this.isEmpty=function(a){for(var b in a)if(a.hasOwnProperty(b))return!1;return!0},this.formatDuration=function(a){if(void 0!==a){var b=new Date(0,0,0);b.setSeconds(Number(a));return(b.getHours()?b.getHours():"")+(b.getMinutes()<10?"0"+b.getMinutes():b.getMinutes())+":"+(b.getSeconds()<10?"0"+b.getSeconds():b.getSeconds())}},this.formatDate=function(a){var b=new Date(1e3*Number(a)),c=""+(b.getMonth()+1),d=""+b.getDate(),e=b.getFullYear();return c.length<2&&(c="0"+c),d.length<2&&(d="0"+d),[c,d,e].join("/")},this.isset=function(a,b){if(arguments.length){var c=a;return b&&(c=a[b]),void 0!==c}},this.debounce=function(a,b,c){var d;return function(){var e=this,f=arguments,g=function(){d=null,c||a.apply(e,f)},h=c&&!d;clearTimeout(d),d=setTimeout(g,b),h&&a.apply(e,f)}},this.trimText=function(a,b){var c=a||"",d=b?Number(b):0;return a.length>d&&(c=c.substring(0,Number(d))+"..."),c},this.trimPrice=function(a){var b=a||"";return b=b.toString().replace(/[^0-9.]+/g,""),b=parseFloat(b).toFixed(2),b=b>0?"$"+b:""},this.tmpl=function(a,b){if(a&&"object"==typeof b)return a.replace(/\{([\w\.]*)\}/g,function(a,c){for(var d=c.split("."),e=b[d.shift()],f=0,g=d.length;f<g;f++)e=e[d[f]];return void 0!==e&&null!==e?e:""})}}a.Utils=new c}(window,document),function(a,b){function c(c,e){this.options=e||{},this.campaign=this.options.campaign||null,this.windowSize=(a.innerWidth||b.documentElement.clientWidth||b.body.clientWidth)<=200?"small":"medium",this.initialResize=!0,this.eventPrefix="tvp_"+(e.id||"").trim().replace(/-/g,"_"),this.isSmall="small"==this.windowSize,this.page=0,this.isLastPage=!1,this.itemsPerPage=this.isSmall?2:e.items_per_page||6,this.itemsPerRow=this.isSmall?1:e.items_per_row||2,this.loginId=e.loginId||e.loginid||0,this.channel=e.channel||{},this.channelId=e.channelid||e.channelId||null,this.loading=!1,this.el="string"==typeof c?b.getElementById(c):c,this.loadBtn=this.el.querySelector(".tvp-sidebar-load"),this.container=this.el.querySelector(".tvp-sidebar-container"),this.sidebarTitle=this.el.querySelector(".tvp-sidebar-title"),this.onLoad=e.onLoad&&Utils.isFunction(e.onLoad)?e.onLoad:null,this.onLoadEnd=e.onLoadEnd&&Utils.isFunction(e.onLoadEnd)?e.onLoadEnd:null,this.onItemClick=e.onItemClick&&Utils.isFunction(e.onItemClick)?e.onItemClick:null,this.emitMessage=function(b){a.parent&&a.parent.postMessage(b||{},"*")},this.renderTitle=function(){e.title_text&&e.title_text.trim().length?this.sidebarTitle.innerHTML=e.title_text:this.sidebarTitle.parentNode.removeChild(this.sidebarTitle)},this.render=function(){this.container.innerHTML="",this.renderTitle();for(var a=this.data.slice(0),c=[];a.length;)c.push(a.splice(0,this.itemsPerPage));for(var d=0;d<c.length;d++){for(var f=c[d],g=b.createDocumentFragment(),h=[];f.length;)h.push(f.splice(0,this.itemsPerRow));for(var i=0;h.length>i;i++){var j=b.createElement("div");j.classList.add("tvp-clearfix");for(var k=h[i],l=0;l<k.length;l++){var m=k[l],n=void 0!==m.entity,o=n?" tvp-ad":"";"medium"===this.windowSize&&this.itemsPerRow>1&&(o+=" col-6"),m.className=o,n?m.entity.title=Utils.trimText(m.entity.title,50):m.title=Utils.trimText(m.title,50),j.innerHTML+=Utils.tmpl(e.templates[n?"sidebar-item-ad":"sidebar-item"],m)}g.appendChild(j)}this.container.appendChild(g),this.emitMessage({event:this.eventPrefix+":render",height:this.el.offsetHeight+"px"})}};var f=this;this.next=function(){this.isLastPage?(this.page=0,this.isLastPage=!1):this.page++},this.resize=function(){var c=(a.innerWidth||b.documentElement.clientWidth||b.body.clientWidth)<=200?"small":"medium",d=function(){f.initialResize||f.emitMessage({event:f.eventPrefix+":resize",height:f.el.offsetHeight+"px"})};if(f.windowSize!==c){f.windowSize=c;var g="small"===c;f.itemsPerPage=g?2:e.itemsPerPage||6,f.itemsPerRow=g?1:e.itemsPerRow||2,f.page=0,f.isLastPage=!1,f.load(function(){f.render(),d()})}else d();f.initialResize=!1},this.el.onclick=function(b){var c=b.target;if(c.classList.contains("tvp-video")){for(var d=c.id.split("-").pop(),e={},g=f.data,h=0;h<g.length;h++){var i=g[h];void 0!==i.entity?d===i.entity.id&&(e=i):d===i.id&&(e=i)}f.emitMessage({runTime:void 0!==a.__TVPage__?__TVPage__:null,event:f.eventPrefix+":video_click",selectedVideo:e,videos:g})}},this.loadBtn.onclick=function(){f.loading||(f.next(),f.load(function(a){a.length?f.render(a):(f.next(),f.load(function(a){f.render(a)}))}))},this.load=function(a){f.loading=!0,this.onLoad&&this.onLoad();var b=function(b){(!b.length||b.length<f.itemsPerPage)&&(f.isLastPage=!0),f.data=b,a(b),f.loading=!1,f.onLoadEnd&&f.onLoadEnd()},c=this.options.api_base_url+"/channels/"+(f.channel.id||f.channelId)+"/videos",e=f.channel.parameters||{};if(e.p=f.page,e.n=f.itemsPerPage,e["X-login-id"]=f.loginId,this.campaign&&f.options.video_spots_endpoint&&0===f.page){var g=new XMLHttpRequest;g.open("GET",f.options.video_spots_endpoint,!0),g.onreadystatechange=function(){if(g.readyState==XMLHttpRequest.DONE){var a=[];200===g.status&&g.responseText.length&&(a=JSON.parse(g.responseText));var f=e.n-a.length;e.n=f>0?f:1e4,d(c,e,function(c){b(a.concat(c))})}},g.send()}else d(c,e,function(a){b(a||[])})},this.load(function(a){a.length&&(f.render(a),f.emitMessage({event:f.eventPrefix+":render"}))}),a.addEventListener("resize",Utils.debounce(this.resize,100))}var d=function(c,d,e){var f=b.createElement("script"),g="tvp_"+Math.floor(555*Math.random());a[g]=e;var h=!0;d=d||{};for(var i in d)h?(c+="?",h=!1):c+="&",c+=i+"="+d[i];c+="&callback="+g,f.src=c,b.body.appendChild(f)};a.Grid=c}(window,document),function(a,b){var c=function(a,b){var c=a;return b&&(c=a[b]),void 0!==c},d=function(d){var e=function(a){if(c(a)&&c(a,"__TVPage__")&&c(a.__TVPage__,"config"))return a.__TVPage__.config},f={};if("dynamic"===d){var g=e(parent),h=b.body.getAttribute("data-id");if(!c(g,h))return;f=g[h],f.name=h}else if("inline"===d&&d&&d.length){var g=e(parent);f=g[d],f.name=d}else if("static"===d){var g=e(a),h=b.body.getAttribute("data-id");if(!c(g,h))return;f=g[h],f.name=h}return f},e=function(a,d){if(c(a)&&c(d)){var e=b.createDocumentFragment(),f=b.createElement("div"),g=d||{};f.id=g.id||"",f.classList.add("iframe-content"),f.innerHTML+=g.templates.sidebar,e.appendChild(f),a.appendChild(e)}},f=b.body,g=function(){!function(a){var c=JSON.parse(JSON.stringify(a)),d=a.name;e(f,a);var g=b.getElementById(d);c.onLoad=function(){g.classList.add("loading")},c.onLoadEnd=function(){g.classList.remove("loading")},new Grid(d,c)}(d("dynamic"))},h=function(a){return void 0===a};if(h(a.Grid)||h(a.Utils)){var i=0;!function b(){setTimeout(function(){h(a.Grid)||h(a.Utils)?++i<50&&b():g()},150)}()}else g()}(window,document);