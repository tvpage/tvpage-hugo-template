!function(){var a=navigator.userAgent,b=function(a,b){return a.hasOwnProperty(b)},c={};c.isMobile=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(a),c.isIOS=/iPad|iPhone|iPod|iPhone Simulator|iPad Simulator/.test(a)&&!window.MSStream,c.getById=function(a){return document.getElementById(a)},c.hasClass=function(a,b){return a.classList.contains(b)},c.loadScript=function(a){var b=document.createElement("script"),c=a.base||"",d=a.params||{},e=0;for(var f in d)d.hasOwnProperty(f)&&(c+=(e>0?"&":"?")+f+"="+d[f],++e);b.src=c,document.body.appendChild(b)},c.sendMessage=function(a){window.parent&&window.parent.postMessage(a,"*")},c.getByClass=function(a){return document.getElementsByClassName(a||"")[0]},c.isUndefined=function(a){return void 0===a},c.isFunction=function(a){return"function"==typeof a},c.copy=function(a){return JSON.parse(JSON.stringify(a))},c.hasKey=b,c.isEmpty=function(a){for(var b in a)if(a.hasOwnProperty(b))return!1;return!0},c.formatDuration=function(a){if(void 0!==a){var b=new Date(0,0,0);b.setSeconds(Number(a));var c=function(a){return a<10?"0"+a:a};return(b.getHours()||"")+c(b.getMinutes())+":"+c(b.getSeconds())}},c.formatDate=function(a){var b=new Date(1e3*Number(a)),c=""+(b.getMonth()+1),d=""+b.getDate(),e=b.getFullYear();return c.length<2&&(c="0"+c),d.length<2&&(d="0"+d),[c,d,e].join("/")},c.isset=function(a,b){if(arguments.length){var c=a;return b&&(c=a[b]),void 0!==c}},c.extend=function(a){a=a||{};for(var b=1;b<arguments.length;b++)if(arguments[b])for(var c in arguments[b])arguments[b].hasOwnProperty(c)&&(a[c]=arguments[b][c]);return a},c.debounce=function(a,b,c){var d=null;return function(){var e=this,f=arguments,g=function(){d=null,c||a.apply(e,f)},h=c&&!d;clearTimeout(d),d=setTimeout(g,b),h&&a.apply(e,f)}},c.trimText=function(a,b){var c=a||"",d=b?Number(b):0;return a.length>d&&(c=c.substring(0,Number(d))+"..."),c},c.trimPrice=function(a){var b=a||"";return b=b.toString().replace(/[^0-9.]+/g,""),b=parseFloat(b).toFixed(2),b=b>0?"$"+b:""},c.getParentConfig=function(a){if(!b(window,"parent")||!b(parent,"__TVPage__"))throw new Error("can't access parent");if(!b(parent.__TVPage__,"config")||!b(parent.__TVPage__.config,a))throw new Error("missing config");return parent.__TVPage__.config[a]},c.tmpl=function(a,b){return!(!a||"object"!=typeof b)&&a.replace(/\{([\w\.]*)\}/g,function(a,c){for(var d=c.split("."),e=b[d.shift()],f=0,g=d.length;f<g;f++)e=e[d[f]];return void 0!==e&&null!==e?e:""})},window.Utils=c}(),function(){function a(){this.config=null}var b=function(a){return void 0===a};a.prototype.getConfigBase=function(a){var b=a||{};return{logUrl:b.logUrl||"",li:b.loginId||"",gaDomain:b.domain||""}},a.prototype.initConfig=function(a){if(b(window._tvpa)||!_tvpa)throw new Error("need _tvpa");this.config=this.getConfigBase(a),a&&a.firstPartyCookies&&a.cookieDomain&&(this.config.firstPartyCookieDomain=a.cookieDomain),_tvpa.push(["config",this.config])},a.prototype.track=function(a,c){b(a)||b(c)||_tvpa.push(["track",a,c])},window.Analytics=a}(),function(){var a=navigator.userAgent,b=/iPad|iPhone|iPod|iPhone Simulator|iPad Simulator/.test(a)&&!window.MSStream,c=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(a),d=function(a){for(var b in a)if(a.hasOwnProperty(b))return!1;return!0},e=function(a){return"function"==typeof a},f=function(a){return void 0===a},g=function(a){for(var b in a)a.hasOwnProperty(b)&&!a[b]&&delete a[b];return a},h=function(a){if(!a||!a.data||a.data.length<=0)throw new Error("need options")},i=function(a){if(!a)throw new Error("need el");return"string"==typeof a?document.getElementById(a):a},j=function(a,b,c){h(b),this.options=b,this.el=i(a),this.eventPrefix=("tvp_"+this.options.id).replace(/-/g,"_"),this.assets=[],this.instance=null,this.initialResize=!0,this.startWith=c||null,this.isFullScreen=!1};j.prototype.getPlayButtonOptions=function(){return g({height:this.getOption("play_button_height"),width:this.getOption("play_button_width"),backgroundColor:this.getOption("play_button_background_color"),borderRadius:this.getOption("play_button_border_radius"),borderWidth:this.getOption("play_button_border_width"),borderColor:this.getOption("play_button_border_color"),borderStyle:this.getOption("play_button_border_style"),iconColor:this.getOption("play_button_icon_color")})},j.prototype.setControlsOptions=function(){this.controls=g({active:!0,seekBar:g({progressColor:this.getOption("progress_color")}),floater:g({controlbarColor:this.getOption("control_bar_color"),iconColor:this.getOption("icon_color"),removeControls:this.getOption("remove_controls")}),playbutton:this.getPlayButtonOptions(),overlayColor:this.getOption("overlay_color"),overlayOpacity:this.getOption("overlay_opacity")})},j.prototype.setAdvertisingOptions=function(){if(this.options.advertising&&!d(this.options.advertising)){var a=this.options.advertising;this.advertising=g({enabled:!!a.enabled,adServerUrl:a.adServerUrl||null,adTimeout:a.adTimeout||"2000",maxAds:a.maxAds||"100",adInterval:f(a.adInterval)?"0":String(a.adInterval)})}},j.prototype.shallCue=function(a){return c||a&&!this.autonext||!this.autoplay},j.prototype.play=function(a,b){this.shallCue(b)?this.instance.cueVideo(a):this.instance.loadVideo(a)},j.prototype.controlBarZindex=function(){var a=this.el.querySelector("#ControlBarFloater");a&&a.parentNode&&(a.parentNode.style.zIndex="9999")},j.prototype.getParentSize=function(a){var b=this.el.parentNode,c=null;return"width"===a?c=b.offsetWidth:"height"===a&&(c=b.offsetHeight),c},j.prototype.resize=function(){if(this.getParentSize){var a=arguments[0]||this.getParentSize("width"),b=arguments[1]||this.getParentSize("height");this.instance&&!this.isFullScreen&&this.instance.resize(a,b),this.initialResize=!1,this.onResize&&this.onResize(this.initialResize,[a,b])}},j.prototype.handleResize=function(){var a=this;if(window.location!==window.parent.location&&b){var c=function(b){if(b&&b.data&&b.data.event&&a.eventPrefix+":external_resize"===b.data.event){var c=b.data.size||[];a.resize(c[0],c[1])}};window.removeEventListener("message",c,!1),window.addEventListener("message",c,!1)}else{var d=function(){a.resize.call(a)};window.removeEventListener("resize",d,!1),window.addEventListener("resize",d,!1)}},j.prototype.analyticsConfig=function(){var a=this.options,b=a.loginId||a.loginid,c={domain:location.hostname||"",logUrl:a.api_base_url+"/__tvpa.gif",loginId:b};a.firstPartyCookies&&a.cookieDomain&&(c.firstPartyCookieDomain=a.cookieDomain),_tvpa.push(["config",c]),this.options.ciTrack&&_tvpa.push(["track","ci",{li:b}])},j.prototype.getCurrentAsset=function(){var a=0,b=this.assets;if(this.startWith)for(var c=0;c<b.length;c++)b[c].assetId===this.startWith&&(a=c);return this.current=a,b[this.current]},j.prototype.onReady=function(a,b){if(this.instance=b,this.resize.call(this),window.BigScreen){var c=this;BigScreen.onchange=function(){c.isFullScreen=!c.isFullScreen,c.resize()}}this.analyticsConfig(),this.controlBarZindex(),this.handleResize(),this.onPlayerReady&&this.onPlayerReady(this),this.play(this.getCurrentAsset())},j.prototype.notifyState=function(a){var b=JSON.parse(JSON.stringify(this.assets[this.current]));b.currentTime=this.instance.getCurrentTime(),this.onPlayerChange&&window.parent&&window.parent.postMessage({event:this.eventPrefix+":on_player_change",e:a,stateData:b},"*")},j.prototype.handleVideoEnded=function(){this.current++,this.assets[this.current]||(this.current=0);var a=this.assets[this.current];this.play(a,!0),this.onNext&&this.onNext(a)},j.prototype.onStateChange=function(a){this.notifyState(a),"tvp:media:videoended"===a&&this.handleVideoEnded()},j.prototype.addExtraConfig=function(a){a=a||{};for(var b=["preload","poster","overlay"],c=0;c<b.length;c++){var d=b[c];f(this[d])||null===this[d]||(a[d]=this[d])}return a},j.prototype.getConfig=function(){return g({techOrder:this.getOption("tech_order"),mediaProviders:this.getOption("media_providers"),analytics:{tvpa:this.getOption("analytics")},apiBaseUrl:this.getOption("api_base_url"),swf:this.flashUrl,divId:this.el.id,controls:this.controls,version:this.version,advertising:this.advertising,preload:this.getOption("preload"),poster:this.getOption("poster"),overlay:this.getOption("overlay")})},j.prototype.startPlayer=function(){var a=0,b=this;!function c(){setTimeout(function(){if(f(window.TVPage)||f(window._tvpa))++a<50?c():console.warn("can't load deps");else{var d=b.getConfig();d.onReady=function(a,c){b.onReady(a,c)},d.onStateChange=function(a){b.onStateChange(a)},b.player=new TVPage.player(d)}},150)}()},j.prototype.getChannelId=function(){var a=0,b=this.options;return b.channel?a=b.channel.id:b.channelId?a=b.channelId:b.channelid&&(a=b.channelid),a},j.prototype.buildAsset=function(a){if(d(a))return{};var b=a.asset;return b.assetId=a.id,b.assetTitle=a.title,b.loginId=a.loginId,b.type=b.type||"youtube",b.analyticsObj={pg:a.parentId||this.getChannelId(),vd:b.assetId,li:b.loginId},b.sources=b.sources||[{file:b.videoId}],b},j.prototype.addAssets=function(a){if(a&&a.length)for(var b=0;b<a.length;b++)this.assets.push(this.buildAsset(a[b]))},j.prototype.getOption=function(a){return f(this.options[a])?null:this.options[a]},j.prototype.getCallable=function(a){return e(this.options[a])?this.options[a]:null},j.prototype.setConfig=function(a){this.version=this.getOption("player_version"),this.flashUrl="//cdnjs.tvpage.com/tvplayer/tvp-"+this.version+".swf",this.autoplay=this.getOption("autoplay"),this.autonext=this.getOption("autonext"),this.onPlayerChange=this.getOption("onPlayerChange"),this.onResize=this.getCallable("onResize"),this.onNext=this.getCallable("onNext"),this.onPlayerReady=this.getCallable("onPlayerReady")},j.prototype.initialize=function(){this.setControlsOptions(),this.setAdvertisingOptions(),this.setConfig(),this.addAssets(this.options.data),this.startPlayer()},window.Player=j}(),function(a,b){function c(a){a.hasOwnProperty("data-simple-scrollbar")||Object.defineProperty(a,"data-simple-scrollbar",new SimpleScrollbar(a))}function d(a,c){function d(a){var b=a.pageY-f;f=a.pageY,g(function(){c.el.scrollTop+=b/c.scrollRatio})}function e(){a.classList.remove("ss-grabbed"),b.body.classList.remove("ss-grabbed"),b.removeEventListener("mousemove",d),b.removeEventListener("mouseup",e)}var f;a.addEventListener("mousedown",function(c){return f=c.pageY,a.classList.add("ss-grabbed"),b.body.classList.add("ss-grabbed"),b.addEventListener("mousemove",d),b.addEventListener("mouseup",e),!1})}function e(a){for(this.target=a,this.bar='<div class="ss-scroll">',this.wrapper=b.createElement("div"),this.wrapper.setAttribute("class","ss-wrapper"),this.el=b.createElement("div"),this.el.setAttribute("class","ss-content"),this.wrapper.appendChild(this.el);this.target.firstChild;)this.el.appendChild(this.target.firstChild);this.target.appendChild(this.wrapper),this.target.insertAdjacentHTML("beforeend",this.bar),this.bar=this.target.lastChild,d(this.bar,this),this.moveBar(),this.el.addEventListener("scroll",this.moveBar.bind(this)),this.el.addEventListener("mouseenter",this.moveBar.bind(this)),this.target.classList.add("ss-container");var c=window.getComputedStyle(a);"0px"===c.height&&"0px"!==c["max-height"]&&(a.style.height=c["max-height"])}function f(){for(var a=b.querySelectorAll("*[ss-container]"),d=0;d<a.length;d++)c(a[d])}var g=a.requestAnimationFrame||a.setImmediate||function(a){return setTimeout(a,0)};e.prototype={moveBar:function(a){var b=this.el.scrollHeight,c=this.el.clientHeight,d=this;this.scrollRatio=c/b,g(function(){d.scrollRatio>=1?d.bar.classList.add("ss-hidden"):(d.bar.classList.remove("ss-hidden"),d.bar.style.cssText="height:"+100*d.scrollRatio+"%; top:"+d.el.scrollTop/b*100+"%;right:-"+(d.target.clientWidth-d.bar.clientWidth)+"px;")})}},b.addEventListener("DOMContentLoaded",f),e.initEl=c,e.initAll=f,a.SimpleScrollbar=e}(window,document),function(){var a=function(a,b){this.options=b||{},this.player=a,this.allVideos=[],this.page=0,this.lastPage=!1,this.isFetching=!1,this.itemsPerPage=6,this.categoryTagAttribute=Utils.isUndefined(this.options.menu_item_play_category_tag_attribute)?null:this.options.menu_item_play_category_tag_attribute};a.prototype.cacheDOM=function(){this.hiddenMenu=document.getElementById("tvp-hidden-menu"),this.scrollMenu=document.querySelectorAll(".ss-content")[0],this.tvpVid=document.querySelectorAll(".tvp-video"),this.hamburguer=document.getElementById("tvp-hamburger-container"),this.toggles=document.querySelectorAll(".tvp-hamburger"),this.payerCont=document.querySelectorAll(".tvp-player")[0],this.noVideosContainer=document.getElementById("tvp-no-videos-container"),this.tvpNoVideos=document.getElementsByClassName("tvp-no-videos"),this.scrollBar=document.getElementsByClassName("ss-scroll")[0],this.slideMenu=document.getElementById("tvp-slide-menu")},a.prototype.renderCategoryValue=function(a,b){if(this.categoryTagAttribute){var c=a[this.categoryTagAttribute];if(c){c=c.replace(/_/g," ");var d=document.createElement("div");d.className="tvp-category-tag",d.innerHTML+=c,b.appendChild(d)}}},a.prototype.renderNoVideos=function(a){var b=document.createElement("div");b.className="tvp-no-videos",a.appendChild(b)},a.prototype.render=function(){var a=this.options.data||[],b=a.length;if(!(b<1)){this.renderFullScreenMenu();var c=document.createElement("div");c.className="tvp-clearfix";var d=document.createElement("div");d.id="tvp-no-videos-container";var e=document.getElementById("tvp-hidden-menu");e.appendChild(d),e.insertBefore(c,d),e.style.cssText="height:"+(document.getElementById("tvp-player-el-"+this.options.id).offsetHeight-40)+"px;";for(var f=document.getElementsByClassName("tvp-video-details"),g=0;g<b;g++){var h=a[g];this.allVideos.push(h),h.title=Utils.trimText(h.title,100),h.duration=Utils.formatDuration(h.duration),c.innerHTML+=Utils.tmpl(this.options.templates["menu-item"],h),this.renderCategoryValue(h,f[g]),b>4&&this.renderNoVideos(d)}SimpleScrollbar.initAll()}},a.prototype.bindMenuEvent=function(){for(var a=this,b=this.toggles.length-1;b>=0;b--)this.toggles[b].onclick=function(){var b=a.player.assets[a.player.current];a.setActiveItem(b.assetId),a.toggleMenu()}},a.prototype.loadMore=function(){if(!this.lastPage&&!this.isFetching){this.page++,this.isFetching=!0;var a=this.options.channel||{};Utils.loadScript({base:this.options.api_base_url+"/channels/"+this.options.channelId+"/videos",params:Utils.extend(a.parameters||{},{"X-login-id":this.options.loginId,p:this.page,n:this.itemsPerPage,callback:"tvpcallback"})});var b=this;window.tvpcallback=function(a){b.isFetching=!1,b.lastPage=!a.length||a.length<b.itemsPerPage,b.player.addAssets(a),b.update(a)}}},a.prototype.bindLoadMoreEvent=function(a){var b=this;this.scrollMenu.addEventListener("scroll",Utils.debounce(function(){var a=b.scrollMenu.scrollTop,c=b.hiddenMenu.clientHeight-b.scrollMenu.scrollHeight,d=100*a/c;d=Math.round(d),(d=Math.abs(d))>=50&&d<=100&&b.loadMore()},30))},a.prototype.bindClickEvent=function(){for(var a=this.tvpVid.length-1;a>=0;a--)this.videoClick(this.tvpVid[a])},a.prototype.toggleMenu=function(){this.slideMenu.classList.contains("active")?this.slideMenu.classList.remove("active"):this.slideMenu.classList.add("active")},a.prototype.hideMenu=function(){this.slideMenu.classList.remove("active")},a.prototype.hideMenuEvents=function(){var a=document.getElementsByClassName("tvp-overlay")[0];a&&(a.onclick=function(){this.hideMenu()})},a.prototype.renderFullScreenMenu=function(){var a=document.getElementById("tvp-player-el-"+this.options.id),b=a.querySelector("iframe"),c=document.createElement("div");c.id="tvp-slide-menu",c.innerHTML=this.options.templates.menu,b.parentNode.insertBefore(c,b.nextSibling)},a.prototype.listenToResize=function(){function a(){var a=this.payerCont.clientHeight-40+"px;";this.hiddenMenu.style.cssText="height:"+a;var b=this.scrollMenu.scrollHeight,c=this.scrollMenu.clientHeight,d=c/b;this.scrollBar.style.cssText+="height:"+Math.floor(100*d)+"%;top:"+this.scrollMenu.scrollTop/b*100+"%;right:-"+(this.hiddenMenu.clientWidth-9)+"px;"}window.removeEventListener("resize",a,!1),window.addEventListener("resize",a,!1)},a.prototype.update=function(a){var b=a.length,c=this,d=function(a){c.allVideos.push(a),c.options.data.push(a)},e=function(a){return Utils.tmpl(c.options.templates["menu-item"],a)};if(this.noVideosContainer){this.deleteDivs();for(var f=0;f<b;f++){var g=a[f];g.duration=Utils.formatDuration(g.duration),d(g),this.noVideosContainer.innerHTML+=e(g),this.scrollMenu.appendChild(this.noVideosContainer),this.renderCategoryValue(g,this.noVideosContainer.getElementsByClassName("tvp-video-details")[f])}}else{var h=document.createElement("div");h.className="tvp-clearfix";for(var f=0;f<b;f++){var g=a[f];g.duration=Utils.formatDuration(g.duration),d(g),h.innerHTML+=e(g),this.renderCategoryValue(g,h.getElementsByClassName("tvp-video-details")[f])}this.scrollMenu.appendChild(h)}this.cacheDOM(),this.bindClickEvent()},a.prototype.deleteDivs=function(){for(var a=this.tvpNoVideos.length-1;a>=0;a--)this.noVideosContainer.removeChild(this.tvpNoVideos[a])},a.prototype.clearActiveItems=function(){for(var a=this.tvpVid.length-1;a>=0;a--)this.tvpVid[a].classList.contains("active")&&this.tvpVid[a].classList.remove("active")},a.prototype.setActiveItem=function(a){for(var b=this.tvpVid.length-1;b>=0;b--){var c=this.tvpVid[b];c.id.split("-").pop()!==a||c.classList.contains("active")||(this.clearActiveItems(),c.classList.add("active"))}},a.prototype.videoClick=function(a){var b=this;a.onclick=function(){if(this.classList.contains("tvp-video")){b.clearActiveItems(),this.classList.add("active");var a=this.id.split("-").pop(),c=b.allVideos.filter(function(b){return b.id===a});b.player.play(b.player.buildAsset(c[0])),b.toggleMenu()}}},a.prototype.initialize=function(){this.render(),this.cacheDOM(),this.bindMenuEvent(),this.bindClickEvent(),this.bindLoadMoreEvent(),this.hideMenuEvents(),this.listenToResize()},window.Menu=a}(),function(){function a(){f(),d=e();var a=d.channel||{},h=a.parameters||{},i=d.api_base_url+"/channels/"+d.channelId+"/videos?X-login-id="+d.loginId;for(var j in h)i+="&"+j+"="+h[j];i+="&p=0&n=6&callback=tvpcallback";var k=document.createElement("script");k.src=i,window.tvpcallback=function(a){a.length&&(Utils.sendMessage({event:("tvp_"+c).replace(/-/g,"_")+":render"}),new Player("tvp-player-el-"+c,g(a)).initialize())},b.appendChild(k)}var b=document.body,c=b.getAttribute("data-id"),d=null,e=function(){if(!Utils.hasKey(window,"parent")||!Utils.hasKey(parent,"__TVPage__"))throw new Error("Can't access window parent");if(!Utils.hasKey(parent.__TVPage__,"config")||!Utils.hasKey(parent.__TVPage__.config,c))throw new Error("Missing widget configuration");var a=parent.__TVPage__.config[c],b=a.channel||{};return a.channelId=b.id||a.channelId||a.channelid,a.loginId=a.loginId||a.loginid,a},f=function(){var a=document.createElement("div");a.className="tvp-player",a.innerHTML='<div id="tvp-player-el-'+c+'" class="tvp-player-el"></div></div>',b.appendChild(a)},g=function(a){var b=Utils.copy(d);return b.ciTrack=!0,b.onPlayerChange=!!d.onPlayerChange,b.data=a||[],d.playlist&&"show"===d.playlist&&(b.onPlayerReady=function(b){var c=Utils.copy(d);c.data=a,new Menu(b,c).initialize()},b.onNext=function(a){menu.setActiveItem(a.assetId),menu.hideMenu()},b.onFullscreenChange=function(){menu.hideMenu()}),b},h=function(){var a=function(a){return void 0===a};return a(window.Utils)||a(window.Player)||a(window.Menu)||a(window.SimpleScrollbar)};if(h()){var i=0;!function b(){setTimeout(function(){h()?++i<200?b():console.warn("limit reached"):a()},150)}()}else a()}();